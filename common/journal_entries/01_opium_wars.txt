je_opium_wars = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_foreign_affairs

	scripted_button = ban_opium_button
	scripted_button = unban_opium_button
		
	complete = {
		OR = {
			has_diplomatic_pact = {
				who = scope:target
				type = foreign_investment_rights
			}
			any_scope_state = {
				is_treaty_port = yes
				state_region = {
					any_scope_state = {
						owner = scope:target
					}
				}
			}
		}
	}

	on_complete = {
		trigger_event = {
			id = opium_wars.5
			days = 5
		}
		#### 추가
		if = {
			limit = {
				this = c:GBR
				scope:target = c:CHI
			}
			save_scope_as = gbr_scope
			c:CHI = {
				save_scope_as = chi_scope
				remove_modifier = supreme_celestial_order
				add_modifier = {
					name = broken_celestial_order
					months = 240
					is_decaying = yes
				}			
			}		
			every_country = {
				limit = {
					OR = {
						country_rank = rank_value:great_power
						country_rank = rank_value:major_power
						country_rank = rank_value:unrecognized_major_power
						country_rank = rank_value:unrecognized_regional_power
					}
					NOT = { this = c:GBR }
					NOT = { this = c:KOR }
					NOT = { this = c:CHI }
					NOT = { this = c:JAP }
				}
				trigger_event = {
					id = lia_event_rtc.1
					days = { 3 7 }
				}			
			}	
			c:KOR = {
				trigger_event = {
					id = lia_event_rtc.2
					days = { 3 7 }
				}
			}
			c:JAP = {
				trigger_event = {
					id = eafp_japan.2007
					days = { 3 7 }
				}
			}
		}
		####
	}

	fail = {
		custom_tooltip = {
			text = opium_wars_fail_tt
			scope:target = {
				NOT = {
					any_primary_culture = {
						has_cultural_obsession = opium
					}
				}
			}
		}
	}

	invalid = {
		NOT = {
			exists = scope:target
		}
	}

	on_invalid = {
		remove_variable = opium_wars_aggressor
	}

	on_fail = {
		custom_tooltip = {
			text = opium_wars_fail_invalid_tt
			remove_variable = opium_wars_aggressor
		}
	}

	on_timeout = {
		custom_tooltip = {
			text = opium_wars_fail_invalid_tt
			remove_variable = opium_wars_aggressor
		}
	}

	weight = 10000
	should_be_pinned_by_default = yes

	timeout = 3650
}
