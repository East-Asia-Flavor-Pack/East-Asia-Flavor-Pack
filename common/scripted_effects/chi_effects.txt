increase_decadent_bannermen_effect = {
	custom_tooltip = {
		text = increase_decadent_bannermen_effect_tt
		if = {
			limit = { has_modifier = decadent_bannermen_7 }
			remove_modifier = decadent_bannermen_7
			add_modifier = decadent_bannermen_8
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_6 }
			remove_modifier = decadent_bannermen_6
			add_modifier = decadent_bannermen_7
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_5 }
			remove_modifier = decadent_bannermen_5
			add_modifier = decadent_bannermen_6
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_4 }
			remove_modifier = decadent_bannermen_4
			add_modifier = decadent_bannermen_5
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_3 }
			remove_modifier = decadent_bannermen_3
			add_modifier = decadent_bannermen_4
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_2 }
			remove_modifier = decadent_bannermen_2
			add_modifier = decadent_bannermen_3
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_1 }
			remove_modifier = decadent_bannermen_1
			add_modifier = decadent_bannermen_2
		}
		else = {
			add_modifier = decadent_bannermen_1
		}
	}
}

decrease_decadent_bannermen_effect = {
	custom_tooltip = {
		text = decrease_decadent_bannermen_effect_tt
		if = {
			limit = { has_modifier = decadent_bannermen_8 }
			remove_modifier = decadent_bannermen_8
			add_modifier = decadent_bannermen_7
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_7 }
			remove_modifier = decadent_bannermen_7
			add_modifier = decadent_bannermen_6
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_6 }
			remove_modifier = decadent_bannermen_6
			add_modifier = decadent_bannermen_5
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_5 }
			remove_modifier = decadent_bannermen_5
			add_modifier = decadent_bannermen_4
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_4 }
			remove_modifier = decadent_bannermen_4
			add_modifier = decadent_bannermen_3
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_3 }
			remove_modifier = decadent_bannermen_3
			add_modifier = decadent_bannermen_2
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_2 }
			remove_modifier = decadent_bannermen_2
			add_modifier = decadent_bannermen_1
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_1 }
			remove_modifier = decadent_bannermen_1
		}
	}
}

largely_decrease_decadent_bannermen_effect = {
	custom_tooltip = {
		text = largely_decrease_decadent_bannermen_effect_tt
		if = {
			limit = { has_modifier = decadent_bannermen_8 }
			remove_modifier = decadent_bannermen_8
			add_modifier = decadent_bannermen_6
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_7 }
			remove_modifier = decadent_bannermen_7
			add_modifier = decadent_bannermen_5
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_6 }
			remove_modifier = decadent_bannermen_6
			add_modifier = decadent_bannermen_4
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_5 }
			remove_modifier = decadent_bannermen_5
			add_modifier = decadent_bannermen_3
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_4 }
			remove_modifier = decadent_bannermen_4
			add_modifier = decadent_bannermen_2
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_3 }
			remove_modifier = decadent_bannermen_3
			add_modifier = decadent_bannermen_1
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_2 }
			remove_modifier = decadent_bannermen_2
		}
		else_if = {
			limit = { has_modifier = decadent_bannermen_1 }
			remove_modifier = decadent_bannermen_1
		}
	}
}

chi_military_academy_gain_progress = {
	change_variable = {
		name = chi_military_academy_progress
		add = 1
	}
	custom_tooltip = chi_military_academy_gain_progress_tt
}
chi_military_academy_gain_large_progress = {
	change_variable = {
		name = chi_military_academy_progress
		add = 2
	}
	custom_tooltip = chi_military_academy_gain_large_progress_tt
}
chi_military_academy_lose_progress = {
	change_variable = {
		name = chi_military_academy_progress
		add = -1
	} 
	custom_tooltip = chi_military_academy_lose_progress_tt
}
chi_military_academy_gain_peril = {
	change_variable = {
		name = chi_military_academy_peril
		add = 1
	}
	custom_tooltip = chi_military_academy_gain_peril_tt
}	
chi_military_academy_gain_large_peril = {
	change_variable = {
		name = chi_military_academy_peril
		add = 2
	}
	custom_tooltip = chi_military_academy_gain_large_peril_tt
}
chi_military_academy_lose_peril = {
	change_variable = {
		name = chi_military_academy_peril
		add = -1
	}
	custom_tooltip = chi_military_academy_lose_peril_tt
}

chi_naval_academy_gain_progress = {
	change_variable = {
		name = chi_naval_academy_progress
		add = 1
	}
	custom_tooltip = chi_naval_academy_gain_progress_tt
}
chi_naval_academy_gain_large_progress = {
	change_variable = {
		name = chi_naval_academy_progress
		add = 2
	}
	custom_tooltip = chi_naval_academy_gain_large_progress_tt
}
chi_naval_academy_lose_progress = {
	change_variable = {
		name = chi_naval_academy_progress
		add = -1
	} 
	custom_tooltip = chi_naval_academy_lose_progress_tt
}
chi_naval_academy_gain_peril = {
	change_variable = {
		name = chi_naval_academy_peril
		add = 1
	}
	custom_tooltip = chi_naval_academy_gain_peril_tt
}	
chi_naval_academy_gain_large_peril = {
	change_variable = {
		name = chi_naval_academy_peril
		add = 2
	}
	custom_tooltip = chi_naval_academy_gain_large_peril_tt
}
chi_naval_academy_lose_peril = {
	change_variable = {
		name = chi_naval_academy_peril
		add = -1
	}
	custom_tooltip = chi_naval_academy_lose_peril_tt
}

chi_mint_centralization_progress = {
	change_variable = {
		name = chi_non_centralized_minting_var
		subtract = 1
	}
	remove_modifier = chi_non_centralized_minting
	if = {
		limit = { var:chi_non_centralized_minting_var = 1 }
		trigger_event = chinese_westernization.403
	}
	else = {
		add_modifier = {
			name = chi_non_centralized_minting
			multiplier = var:chi_non_centralized_minting_var
		}
	}
	custom_tooltip = chi_mint_centralization_progress_tt
}

chi_the_empire_of_chimera_decline = {
	change_variable = {
		name = the_empire_of_chimera_var
		subtract = 1
	}
	remove_modifier = the_empire_of_chimera
	if = {
		limit = { var:the_empire_of_chimera_var = 0 }
		remove_variable = the_empire_of_chimera_var
	}
	else = {
		add_modifier = {
			name = the_empire_of_chimera
			multiplier = var:the_empire_of_chimera_var
		}
	}
	custom_tooltip = chi_the_empire_of_chimera_decline_tt
}

je_dowager_cixi_calc = { # TODO
	# 영향 계산
	set_variable = {
		name = cixi_influence
		value = {
			value = ig:ig_devout.ig_clout
			add = {
				value = ig:ig_landowners.ig_clout
				divide = 2
			}
		}
	}
	if = {
		limit = { ig:ig_armed_forces = { has_ideology = ideology_stratocratic } }
		change_variable = {
			name = cixi_influence
			add = {
				value = ig:ig_armed_forces.ig_clout
				divide = 2
			}
		}
		if = {
			limit = { has_ruling_interest_group = ig_armed_forces }
			change_variable = {
				name = cixi_influence
				add = {
					value = ig:ig_armed_forces.ig_clout
					divide = 4
				}
			}
		}
	}
	if = {
		limit = { has_ruling_interest_group = ig_devout }
		change_variable = {
			name = cixi_influence
			add = {
				value = ig:ig_devout.ig_clout
				divide = 4
			}
		}
	}
	if = {
		limit = { has_ruling_interest_group = ig_landowners }
		change_variable = {
			name = cixi_influence
			add = {
				value = ig:ig_landowners.ig_clout
				divide = 2
			}
		}
	}

	# 찬성 계산
	set_variable = {
		name = cixi_approval
		value = {
			value = {
				value = ig:ig_devout.ig_clout
				multiply = ig:ig_devout.ig_approval
			}
			add = {
				value = ig:ig_landowners.ig_clout
				multiply = ig:ig_landowners.ig_approval
				divide = 2
			}
		}
	}
	if = {
		limit = { ig:ig_armed_forces = { has_ideology = ideology_stratocratic } }
		change_variable = {
			name = cixi_approval
			add = {
				value = ig:ig_armed_forces.ig_clout
				multiply = ig:ig_armed_forces.ig_approval
				divide = 2
			}
		}
		if = {
			limit = { has_ruling_interest_group = ig_armed_forces }
			change_variable = {
				name = cixi_approval
				add = {
					value = ig:ig_armed_forces.ig_clout
					multiply = ig:ig_armed_forces.ig_approval
					divide = 4
				}
			}
		}
	}
	if = {
		limit = { has_ruling_interest_group = ig_devout }
		change_variable = {
			name = cixi_approval
			add = {
				value = ig:ig_devout.ig_clout
				multiply = ig:ig_devout.ig_approval
				divide = 4
			}
		}
	}
	if = {
		limit = { has_ruling_interest_group = ig_landowners }
		change_variable = {
			name = cixi_approval
			add = {
				value = ig:ig_landowners.ig_clout
				multiply = ig:ig_landowners.ig_approval
				divide = 2
			}
		}
	}
	change_variable = {
		name = cixi_approval
		divide = var:cixi_influence
	}

	change_variable = {
		name = cixi_approval
		multiply = 10
	}
	change_variable = {
		name = cixi_influence
		multiply = 10
	}

	# 영향 계산
	if = {
		limit = { scope:Xingzhen_Yehe_Nara_scope = { has_trait = chi_regent } }
		change_variable = {
			name = cixi_influence
			add = 2.5
		}
	}
	if = {
		limit = { scope:Xingzhen_Yehe_Nara_scope = { has_trait = chi_the_elder_of_the_imperial_family } }
		change_variable = {
			name = cixi_influence
			add = 1
		}
	}
	# 찬성 계산
	if = {
		limit = {
			OR = {
				is_enacting_law = law_type:law_theocracy
				is_enacting_law = law_type:law_presidential_republic
				is_enacting_law = law_type:law_parliamentary_republic
				is_enacting_law = law_type:law_council_republic
			}
		}
		change_variable = {
			name = cixi_approval
			add = -20
		}
	}
	if = {
		limit = {
			is_enacting_law = law_type:law_total_separation
		}
		change_variable = {
			name = cixi_approval
			add = -2.5
		}
	}
	if = {
		limit = {
			enacting_any_law = yes
			currently_enacting_law.type = {
				is_same_law_group_as = law_type:law_autocracy
			}
		}
		if = {
			limit = {
				OR = {
					is_enacting_law = law_type:law_oligarchy
					is_enacting_law = law_type:law_landed_voting
				}
			}
			change_variable = {
				name = cixi_approval
				add = -5
			}
		}
		if = {
			limit = {
				is_enacting_law = law_type:law_wealth_voting
			}
			change_variable = {
				name = cixi_approval
				add = -10
			}
		}
		if = {
			limit = {
				is_enacting_law = law_type:law_census_voting
			}
			change_variable = {
				name = cixi_approval
				add = -15
			}
		}
		if = {
			limit = {
				is_enacting_law = law_type:law_universal_suffrage
			}
			change_variable = {
				name = cixi_approval
				add = -20
			}
		}
	}
	else = {
		if = {
			limit = {
				OR = {
					has_law = law_type:law_oligarchy
					has_law = law_type:law_landed_voting
				}
			}
			change_variable = {
				name = cixi_approval
				add = -5
			}
		}
		if = {
			limit = {
				has_law = law_type:law_wealth_voting
			}
			change_variable = {
				name = cixi_approval
				add = -10
			}
		}
		if = {
			limit = {
				has_law = law_type:law_census_voting
			}
			change_variable = {
				name = cixi_approval
				add = -15
			}
		}
		if = {
			limit = {
				has_law = law_type:law_universal_suffrage
			}
			change_variable = {
				name = cixi_approval
				add = -20
			}
		}
	}
	if = {
		limit = {
			has_variable = manchus_and_han
			NOR = {
				is_enacting_law = law_type:law_autocracy
				AND = {
					NAND = {
						enacting_any_law = yes
						currently_enacting_law.type = {
							is_same_law_group_as = law_type:law_autocracy
						}
					}
					has_law = law_type:law_autocracy
				}
			}
		}
		change_variable = {
			name = cixi_approval
			add = 5
		}
	}

	clamp_variable = {
		name = cixi_influence
		max = 10
		min = 0
	}
}