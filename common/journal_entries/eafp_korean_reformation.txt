je_korean_reformation = {
	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	group = je_group_historical_content

	is_shown_in_lobby = {
		c:KOR ?= THIS
	}

	is_shown_when_inactive = {
        c:KOR ?= THIS
    }

	possible = {
        custom_tooltip = {
			text = je_korean_land_problem_complete_cond_tt
			has_variable = eafp_var_sam_all_clear
		}
    }

    immediate = {
        set_variable = {
            name = korean_reformation_var
            value = 0
        }
		hidden_effect = {
			trigger_event = {
				id = gunmin_dongchi_events.1
				months = { 6 12 }
				popup = yes
			}
		}
		add_journal_entry = {
			type = je_korean_reformation_society
		}
		add_journal_entry = {
			type = je_korean_reformation_military
		}
		add_journal_entry = {
			type = je_korean_reformation_economy
		}
		add_journal_entry = {
			type = je_korean_reformation_diplomacy
		}
    }

	complete = {
		scope:journal_entry = {
			is_goal_complete = yes
		}
		custom_tooltip = {
			text = has_completed_korean_reformation_society_je_tt
			has_variable = completed_je_korean_reformation_society
		}
		custom_tooltip = {
			text = has_completed_korean_reformation_military_je_tt
			has_variable = completed_je_korean_reformation_military
		}
        custom_tooltip = {
			text = has_completed_korean_reformation_economy_je_tt
			has_variable = completed_je_korean_reformation_economy
		}custom_tooltip = {
			text = has_completed_korean_reformation_diplomacy_je_tt
			has_variable = completed_je_korean_reformation_diplomacy
		}
	}
	
	on_complete = {
        set_variable = korean_reformation_complete_var
	}

    current_value = {
		value = var:korean_reformation_var
	}

	goal_add_value = {
		add = 4
	}

    progressbar = yes

	should_be_pinned_by_default = yes

	weight = 10000
}
je_korean_reformation_society = {
	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	group = je_group_historical_content
	
	immediate = {
		set_variable = {
			name = korref104_delay
			months = { 6 30 }
		}
		trigger_event = {
			id = eafp_korean_reformation_events.506
			months = { 6 12 }
		}
	}

	complete = {
		NOR = { 
			has_law_or_variant = law_type:law_hereditary_bureaucrats
			has_law_or_variant = law_type:law_serfdom
			has_law_or_variant = law_type:law_traditionalism
			has_law_or_variant = law_type:law_closed_borders
			has_law_or_variant = law_type:law_isolationism
			has_law_or_variant = law_type:law_land_based_taxation
			has_law_or_variant = law_type:law_consumption_based_taxation
			has_law_or_variant = law_type:law_no_police
			has_law_or_variant = law_type:law_no_schools

			any_civil_war = {
				civil_war_progress > 0.1
				is_civil_war_type = revolution
			}
		}
		bureaucracy > 0
	}

	on_complete = {
		change_variable = {
			name = korean_reformation_var
			add = 1
		}
		trigger_event = {
			id = eafp_korean_reformation_events.199
		}
		set_variable = completed_je_korean_reformation_society

		hidden_effect = {
			trigger_event = { id = eafp_korean_reformation_events.101 }
			trigger_event = { id = eafp_korean_reformation_events.102 }
			#trigger_event = { id = eafp_korean_reformation_events.103 }
			trigger_event = { id = eafp_korean_reformation_events.104 }
			trigger_event = { id = eafp_korean_reformation_events.105 }
		}
	}

	on_monthly_pulse = {
		events = {
			eafp_korean_reformation_events.101 # 경무청
			eafp_korean_reformation_events.102 # 소학교령
			#eafp_korean_reformation_events.103 # 문관전고소
			eafp_korean_reformation_events.104 # 국문이냐 한문이냐
			eafp_korean_reformation_events.105 # 노비들의 운명
		}
	}

	weight = 8000

	should_be_pinned_by_default = yes
}
je_korean_reformation_military = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_historical_content


	complete = {
		has_law_or_variant = law_type:law_professional_army
		any_scope_building = {
			is_building_type = building_arms_industry
		}
		any_scope_building = {
			filter = { is_building_type = building_arms_industry }
			percent >= 0.75
			level >= 5
			OR = {
				has_active_production_method = pm_rifles
				has_active_production_method = pm_repeaters
				has_active_production_method = pm_bolt_action_rifles
			}
			weekly_profit > 0
			cash_reserves_ratio >= 0.25
			occupancy >= 0.75
		}
		any_scope_building = {
			count = all
			NOT = { has_active_production_method = pm_no_organization }
		}
		NOT = {
			any_military_formation = {
				filter = {
					is_army = yes
				}
				any_combat_unit = {
					has_unit_type = unit_type:combat_unit_type_irregular_infantry
				}
				percent >= 0.25
			}
		}
		has_technology_researched = electric_telegraph
	}

	on_complete = {
		change_variable = {
			name = korean_reformation_var
			add = 1
		}
		trigger_event = {
			id = eafp_korean_reformation_events.299
		}
		set_variable = completed_je_korean_reformation_military

		hidden_effect = {
			trigger_event = { id = eafp_korean_reformation_events.201 }
			trigger_event = { id = eafp_korean_reformation_events.202 }
			trigger_event = { id = eafp_korean_reformation_events.203 }
			trigger_event = { id = eafp_korean_reformation_events.204 }
			trigger_event = { id = eafp_korean_reformation_events.205 }
		}
	}

	on_monthly_pulse = {
		events = {
			eafp_korean_reformation_events.201
			eafp_korean_reformation_events.202
			eafp_korean_reformation_events.203
			eafp_korean_reformation_events.204
			eafp_korean_reformation_events.205
		}
	}
	
	weight = 8000

	should_be_pinned_by_default = yes
}
je_korean_reformation_economy = {
	icon = "gfx/interface/icons/event_icons/event_industry.dds"

	group = je_group_historical_content
	
	immediate = {
	}

	complete = {
		any_scope_state = {
			filter = {
				is_incorporated = yes
			}
			percent > 0.7
			has_building = building_railway
			any_scope_building = {
				is_building_type = building_urban_center
				level >= 5
			}
		}
		any_scope_building = {
			is_building_type = building_railway
			level >= 5
		}

		any_scope_state = {
			percent >= 0.5
			any_scope_building = {
				is_building_type = building_urban_center
				level >= 5
			}
		}
		any_scope_state = {
			percent >= 0.1
			any_scope_building = {
				is_building_type = building_urban_center
				level >= 10
			}
		}

		any_scope_building = {
			is_building_type = building_textile_mill
			level >= 5
		}
		any_scope_building = {
			filter = { is_building_type = building_textile_mill }
			percent >= 0.75
			OR = {
				has_active_production_method = pm_sewing_machines
				has_active_production_method = pm_electric_sewing_machines
			}
			weekly_profit > 0
			cash_reserves_ratio >= 0.25
			occupancy >= 0.75
			is_subsidized = no
		}

		any_scope_building = {
			is_building_type = building_furniture_manufactory
			level >= 5
		}
		any_scope_building = {
			filter = { is_building_type = building_furniture_manufactory }
			percent >= 0.75
			OR = {
				has_active_production_method = pm_lathe
				has_active_production_method = pm_mechanized_workshops
			}
			weekly_profit > 0
			cash_reserves_ratio >= 0.25
			occupancy >= 0.75
			is_subsidized = no
		}

		any_scope_building = {
			is_building_type = building_tooling_workshop
			level >= 5
		}
		any_scope_building = {
			filter = { is_building_type = building_tooling_workshop }
			percent >= 0.75
			OR = {
				has_active_production_method = pm_steel
				has_active_production_method = pm_rubber_grips
			}
			weekly_profit > 0
			cash_reserves_ratio >= 0.25
			occupancy >= 0.75
			is_subsidized = no
		}

		any_scope_building = {
			OR = {
				is_building_type = building_coal_mine
				is_building_type = building_iron_mine
				is_building_type = building_lead_mine
				is_building_type = building_sulfur_mine
			}
			level >= 5
		}
		any_scope_building = {
			filter = {
				OR = {
					is_building_type = building_coal_mine
					is_building_type = building_iron_mine
					is_building_type = building_lead_mine
					is_building_type = building_sulfur_mine
				}
			}
			percent >= 0.75
			OR = {
				has_active_production_method = pm_condensing_engine_pump_building_coal_mine
				has_active_production_method = pm_condensing_engine_pump_building_iron_mine
				has_active_production_method = pm_condensing_engine_pump_building_lead_mine
				has_active_production_method = pm_condensing_engine_pump_building_sulfur_mine
				has_active_production_method = pm_diesel_pump_building_coal_mine
				has_active_production_method = pm_diesel_pump_building_iron_mine
				has_active_production_method = pm_diesel_pump_building_lead_mine
				has_active_production_method = pm_diesel_pump_building_sulfur_mine
            }
			weekly_profit > 0
			cash_reserves_ratio >= 0.25
			occupancy >= 0.75
			is_subsidized = no
		}

		has_technology_researched = central_banking
	}

	on_complete = {
		change_variable = {
			name = korean_reformation_var
			add = 1
		}
		trigger_event = {
			id = eafp_korean_reformation_events.399
		}
		set_variable = completed_je_korean_reformation_economy

		hidden_effect = {
			trigger_event = { id = eafp_korean_reformation_events.301 }
			trigger_event = { id = eafp_korean_reformation_events.302 }
			trigger_event = { id = eafp_korean_reformation_events.303 }
			trigger_event = { id = eafp_korean_reformation_events.304 }
			trigger_event = { id = eafp_korean_reformation_events.305 }
			trigger_event = { id = eafp_korean_reformation_events.306 }
			trigger_event = { id = eafp_korean_reformation_events.307 }
			trigger_event = { id = eafp_korean_reformation_events.308 }
		}
	}

	on_monthly_pulse = {
		events = {
			eafp_korean_reformation_events.301
			eafp_korean_reformation_events.302
			eafp_korean_reformation_events.303
			eafp_korean_reformation_events.304
			eafp_korean_reformation_events.305
			eafp_korean_reformation_events.306
			eafp_korean_reformation_events.307
			eafp_korean_reformation_events.308
		}
	}

	weight = 8000

	should_be_pinned_by_default = yes
}
je_korean_reformation_diplomacy = {
	icon = "gfx/interface/icons/event_icons/event_industry.dds"

	group = je_group_historical_content
	
	immediate = {
	}

	complete = {
		NOT = { has_law_or_variant = law_type:law_isolationism }
		NOT = { has_law_or_variant = law_type:law_traditionalism }
		NOT = { has_law_or_variant = law_type:law_closed_borders }
		is_subject = no
		is_country_type = recognized
	}

	on_complete = {
		change_variable = {
			name = korean_reformation_var
			add = 1
		}
		#trigger_event = {
		#	id = eafp_korean_reformation_events.199
		#}
		set_variable = completed_je_korean_reformation_diplomacy

	}

	weight = 8000

	should_be_pinned_by_default = yes
}

je_seoul_improvement_project = {
    icon = "gfx/interface/icons/event_icons/event_trade.dds"

    group = je_group_internal_affairs

    is_shown_when_inactive = {
        c:KOR ?= this
    }

	possible = {
		s:STATE_SEOUL = {
			contains_capital_of = c:KOR
			pollution_amount > 75
		}
	}

	scripted_progress_bar = eafp_progress_bar_seoul_improvement_project

	scripted_button = eafp_scripted_button_seoul_improvement_project
	scripted_button = eafp_scripted_button_seoul_improvement_project2

    immediate = {
        set_variable = {
			name = eafp_var_seoul_improvement_project_weekly
			value = 0
		}
		s:STATE_SEOUL.region_state:KOR = {
			add_modifier = {
				name = eafp_modi_seoul_improvement_project_cost
				multiplier = 0
			}
		}
    }

    complete = {
        custom_tooltip = {
			text = je_korean_imsul_uprising_goal
			scope:journal_entry = {
				"scripted_bar_progress(eafp_progress_bar_seoul_improvement_project)" >= 200
			}
		}
		has_technology_researched = modern_sewerage
		capital = {
			has_building = building_urban_center
			has_building = building_railway
			NOT = {
				any_scope_building = {
					OR = {
						has_active_production_method = pm_market_stalls
						has_active_production_method = pm_market_squares
						has_active_production_method = pm_no_street_lighting
						has_active_production_method = pm_no_public_transport
					}
				}
			}
		}
    }

    on_complete = {
        trigger_event = { id = seoul_improvement_project_events.1 popup = yes }
		remove_variable = eafp_var_seoul_improvement_project_weekly
		every_state = {
			limit = { has_modifier = eafp_modi_seoul_improvement_project_cost }
			remove_modifier = eafp_modi_seoul_improvement_project_cost
		}
    }

	fail = {
		NOT = {
			has_state_in_state_region = STATE_SEOUL
		}
	}

	on_fail = {
		remove_variable = eafp_var_seoul_improvement_project_weekly
		every_state = {
			limit = { has_modifier = eafp_modi_seoul_improvement_project_cost }
			remove_modifier = eafp_modi_seoul_improvement_project_cost
		}
	}

	on_weekly_pulse = {
		effect = {
			if = {
				limit = { scope:journal_entry = { "scripted_bar_progress(eafp_progress_bar_seoul_improvement_project)" >= 200 } }
				s:STATE_SEOUL.region_state:KOR ?= {
					remove_modifier = eafp_modi_seoul_improvement_project_cost
					add_modifier = {
						name = eafp_modi_seoul_improvement_project_cost
						multiplier = 0
					}
				}
			}
		}
	}

    weight = 1000
    should_be_pinned_by_default = yes
}

je_gunmin_dongchi = {
    icon = "gfx/interface/icons/event_icons/waving_flag.dds"

    group = je_group_historical_content

    is_shown_when_inactive = {
        c:KOR ?= this
		has_law_or_variant = law_type:law_monarchy
    }

	possible = {
		hidden_trigger = {
			has_variable = eafp_check_evt_gundon001
		}
	}

	scripted_progress_bar = eafp_progress_bar_gunmin_dongchi_enlightenment
	scripted_progress_bar = eafp_progress_bar_gunmin_dongchi_antiwestern

	scripted_button = eafp_scripted_button_gunmin_dongchi_support_enlightenment
	scripted_button = eafp_scripted_button_gunmin_dongchi_cease_support
	scripted_button = eafp_scripted_button_gunmin_dongchi_support_antiwestern

    immediate = {
        if = {
			limit = {
				NOT = {
					any_political_movement = {
						is_political_movement_type = movement_liberal
					}
				}
			}
			create_political_movement = { type = movement_liberal }
		}
		gunmin_dongchi_var_update_effect = yes
    }

    modifiers_while_active = {
        modifier_suffrage_support_socdem_party
    }

	custom_completion_header = je_gunmin_dongchi_complete_header

    complete = {
        custom_tooltip = {
			text = je_gunmin_dongch_complete_tt
			je:je_gunmin_dongchi ?= {
				"scripted_bar_progress(eafp_progress_bar_gunmin_dongchi_enlightenment)" >= 100
			}
		}
    }

	custom_on_completion_header = je_gunmin_dongchi_on_complete_header

    on_complete = {
        trigger_event = { id = gunmin_dongchi_events.2 popup = yes }
		show_as_tooltip = {
			if = {
				limit = { is_subject = yes }
				add_liberty_desire = 50
			}
			gunmin_dongchi_enlightenment_coup_law_effect = yes

			add_modifier = {
				name = eafp_modi_gunmin_dongchi_enlightenment_coup
				days = normal_modifier_time
			}
			recalculate_pop_ig_support = yes

			every_political_movement = {
				limit = {
					movement_is_conservative = yes
				}
				add_modifier = {
					name = eafp_modi_gunmin_dongchi_enlightenment_coup_movement
					days = short_modifier_time
					is_decaying = yes
				}
			}
		}
		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
    }

	custom_failure_header = je_gunmin_dongchi_fail_header

	fail = {
		custom_tooltip = {
			text = je_gunmin_dongch_fail_tt
			je:je_gunmin_dongchi ?= {
				"scripted_bar_progress(eafp_progress_bar_gunmin_dongchi_antiwestern)" >= 100
			}
		}
	}

	custom_on_failure_header = je_gunmin_dongchi_on_fail_header

	on_fail = {
		trigger_event = { id = gunmin_dongchi_events.3 popup = yes }
		show_as_tooltip = {
			if = {
				limit = { is_subject = yes }
				add_liberty_desire = 50
			}
			gunmin_dongchi_antiwestern_coup_law_effect = yes

			add_modifier = {
				name = eafp_modi_gunmin_dongchi_antiwestern_coup
				days = normal_modifier_time
			}
			recalculate_pop_ig_support = yes

			every_political_movement = {
				limit = {
					OR = {
						movement_is_liberal = yes
						movement_is_socialist = yes
					}
				}
				add_modifier = {
					name = eafp_modi_gunmin_dongchi_antiwestern_coup_movement
					days = short_modifier_time
					is_decaying = yes
				}
			}
		}
		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
	}

    timeout = 7300

    on_timeout = {
        if = {
			limit = { country_has_voting_franchise = yes }
			trigger_event = { id = gunmin_dongchi_events.4 popup = yes }
		}
		else = {
			trigger_event = { id = gunmin_dongchi_events.5 popup = yes }
		}
		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
    }

	invalid = {
		NOT = { has_law_or_variant = law_type:law_monarchy }
	}

	on_invalid = {
		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
	}

	on_weekly_pulse = {
		effect = {
			gunmin_dongchi_var_update_effect = yes
		}
	}

    weight = 1000
    should_be_pinned_by_default = yes
}
je_gunmin_dongchi_enlightenment_coup = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"

    group = je_group_historical_content

	scripted_progress_bar = eafp_progress_bar_gunmin_dongchi_enlightenment_coup_progress
	scripted_progress_bar = eafp_progress_bar_gunmin_dongchi_enlightenment_coup_anticoup

	immediate = {
		#실패 시 저널 추가할 때 법률로 롤백.
		every_active_law = {
			ROOT = {
				add_to_variable_list = {
					name = gunmin_dongchi_initial_lawtype_varlist
					target = PREV.type
				}
			}
		}

		if = {
			limit = { is_subject = yes }
			add_liberty_desire = 50
		}
		gunmin_dongchi_enlightenment_coup_law_effect = yes

		add_modifier = {
			name = eafp_modi_gunmin_dongchi_enlightenment_coup
			days = normal_modifier_time
		}
		recalculate_pop_ig_support = yes

		every_political_movement = {
			limit = {
				movement_is_conservative = yes
			}
			add_modifier = {
				name = eafp_modi_gunmin_dongchi_enlightenment_coup_movement
				days = short_modifier_time
				is_decaying = yes
			}
		}

		gunmin_dongchi_var_update_effect = yes
	}

    complete = {
		has_law_or_variant = law_type:law_dedicated_police
		has_law_or_variant = law_type:law_professional_army
		NOT = { has_law_or_variant = law_type:law_outlawed_dissent }
		NOT = { has_law_or_variant = law_type:law_censorship }
		NOT = { has_law_or_variant = law_type:law_no_womens_rights }
		NOT = { has_law_or_variant = law_type:law_state_religion }
		NOT = { has_law_or_variant = law_type:law_guild_system }
		country_has_voting_franchise = yes

        custom_tooltip = {
			text = je_gunmin_dongchi_enlightenment_coup_complete_tt
			je:je_gunmin_dongchi_enlightenment_coup ?= {
				"scripted_bar_progress(eafp_progress_bar_gunmin_dongchi_enlightenment_coup_progress)" >= 60
			}
		}
		OR = {
			ig:ig_intelligentsia ?= { is_in_government = yes }
			ig:ig_industrialists ?= { is_in_government = yes }
		}
    }

    on_complete = {
        trigger_event = { id = gunmin_dongchi_events.101 popup = yes }
		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
    }

	fail = {
		OR = {
			has_law_or_variant = law_type:law_serfdom
			has_law_or_variant = law_type:law_traditionalism
			has_law_or_variant = law_type:law_isolationism
			has_law_or_variant = law_type:law_land_based_taxation
			custom_tooltip = {
				text = je_gunmin_dongchi_enlightenment_coup_fail_tt
				je:je_gunmin_dongchi_enlightenment_coup ?= {
					"scripted_bar_progress(eafp_progress_bar_gunmin_dongchi_enlightenment_coup_anticoup)" >= 100
				}
			}
		}
	}

	on_fail = {
		trigger_event = { id = gunmin_dongchi_events.102 popup = yes }

		custom_tooltip = je_gunmin_dongchi_enlightenment_coup_on_fail_tt
		every_in_list = {
			limit = { ROOT = { NOT = { has_law = PREV } } }
			variable = gunmin_dongchi_initial_lawtype_varlist

			ROOT = {
				if = {
					limit = { PREV = law_type:law_scholar_bureaucrats }
					if = {
						limit = {
							NOT = { has_law_or_variant = law_type:law_state_religion }
							NOT = { has_law_or_variant = law_type:law_peasant_levies }
							NOT = { has_law_or_variant = law_type:law_serfdom }
						}
						activate_law = law_type:law_appointed_bureaucrats
					}
					else = {
						activate_law = law_type:law_scholar_bureaucrats
						add_journal_entry = {
							type = je_scholar_bureaucrats
						}
					}
				}
				else = {
					activate_law = PREV
				}
			}
		}

		if = {
			limit = { has_modifier = eafp_modi_gunmin_dongchi_enlightenment_coup }
			remove_modifier = eafp_modi_gunmin_dongchi_enlightenment_coup
		}
		recalculate_pop_ig_support = yes

		every_political_movement = {
			limit = {
				has_modifier = eafp_modi_gunmin_dongchi_enlightenment_coup_movement
			}
			remove_modifier = eafp_modi_gunmin_dongchi_enlightenment_coup_movement
		}

		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
	}

    timeout = 3650

    on_timeout = {
        trigger_event = { id = gunmin_dongchi_events.102 popup = yes }

		custom_tooltip = je_gunmin_dongchi_enlightenment_coup_on_fail_tt
		every_in_list = {
			limit = { ROOT = { NOT = { has_law = PREV } } }
			variable = gunmin_dongchi_initial_lawtype_varlist

			ROOT = {
				if = {
					limit = { PREV = law_type:law_scholar_bureaucrats }
					if = {
						limit = {
							NOT = { has_law_or_variant = law_type:law_state_religion }
							NOT = { has_law_or_variant = law_type:law_peasant_levies }
							NOT = { has_law_or_variant = law_type:law_serfdom }
						}
						activate_law = law_type:law_appointed_bureaucrats
					}
					else = {
						activate_law = law_type:law_scholar_bureaucrats
						add_journal_entry = {
							type = je_scholar_bureaucrats
						}
					}
				}
				else = {
					activate_law = PREV
				}
			}
		}

		if = {
			limit = { has_modifier = eafp_modi_gunmin_dongchi_enlightenment_coup }
			remove_modifier = eafp_modi_gunmin_dongchi_enlightenment_coup
		}
		recalculate_pop_ig_support = yes

		every_political_movement = {
			limit = {
				has_modifier = eafp_modi_gunmin_dongchi_enlightenment_coup_movement
			}
			remove_modifier = eafp_modi_gunmin_dongchi_enlightenment_coup_movement
		}

		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
    }

	invalid = {
		NOT = { has_law_or_variant = law_type:law_monarchy }
	}

	on_invalid = {
		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
	}

	on_weekly_pulse = {
		effect = {
			gunmin_dongchi_var_update_effect = yes
		}
	}

    weight = 1000
    should_be_pinned_by_default = yes
}
je_gunmin_dongchi_antiwestern_coup = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"

    group = je_group_historical_content

	scripted_progress_bar = eafp_progress_bar_gunmin_dongchi_antiwestern_coup_progress
	scripted_progress_bar = eafp_progress_bar_gunmin_dongchi_antiwestern_coup_anticoup

	immediate = {
		#실패 시 저널 추가할 때 법률로 롤백.
		every_active_law = {
			ROOT = {
				add_to_variable_list = {
					name = gunmin_dongchi_initial_lawtype_varlist
					target = PREV.type
				}
			}
		}

		if = {
			limit = { is_subject = yes }
			add_liberty_desire = 50
		}
		gunmin_dongchi_antiwestern_coup_law_effect = yes

		add_modifier = {
			name = eafp_modi_gunmin_dongchi_antiwestern_coup
			days = normal_modifier_time
		}
		recalculate_pop_ig_support = yes

		every_political_movement = {
			limit = {
				OR = {
					movement_is_liberal = yes
					movement_is_socialist = yes
				}
			}
			add_modifier = {
				name = eafp_modi_gunmin_dongchi_antiwestern_coup_movement
				days = short_modifier_time
				is_decaying = yes
			}
		}

		gunmin_dongchi_var_update_effect = yes
	}

    complete = {
		has_law_or_variant = law_type:law_no_womens_rights

        custom_tooltip = {
			text = je_gunmin_dongchi_antiwestern_coup_complete_tt
			je:je_gunmin_dongchi_antiwestern_coup ?= {
				"scripted_bar_progress(eafp_progress_bar_gunmin_dongchi_antiwestern_coup_progress)" >= 60
			}
		}
		OR = {
			ig:ig_landowners ?= { is_in_government = yes }
			ig:ig_devout ?= { is_in_government = yes }
		}
    }

    on_complete = {
        trigger_event = { id = gunmin_dongchi_events.102 popup = yes }
		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
    }

	fail = {
		OR = {
			NOT = { has_law_or_variant = law_type:law_autocracy }
			NOT = { has_law_or_variant = law_type:law_state_religion }
			NOT = { has_law_or_variant = law_type:law_isolationism }
			NOT = { has_law_or_variant = law_type:law_censorship }
			custom_tooltip = {
				text = je_gunmin_dongchi_antiwestern_coup_fail_tt
				je:je_gunmin_dongchi_antiwestern_coup ?= {
					"scripted_bar_progress(eafp_progress_bar_gunmin_dongchi_antiwestern_coup_anticoup)" >= 100
				}
			}
		}
	}

	on_fail = {
		trigger_event = { id = gunmin_dongchi_events.202 popup = yes }
		
		custom_tooltip = je_gunmin_dongchi_antiwestern_coup_on_fail_tt
		every_in_list = {
			limit = { ROOT = { NOT = { has_law = PREV } } }
			variable = gunmin_dongchi_initial_lawtype_varlist

			ROOT = {
				if = {
					limit = { PREV = law_type:law_scholar_bureaucrats }
					if = {
						limit = {
							NOT = { has_law_or_variant = law_type:law_state_religion }
							NOT = { has_law_or_variant = law_type:law_peasant_levies }
							NOT = { has_law_or_variant = law_type:law_serfdom }
						}
						activate_law = law_type:law_appointed_bureaucrats
					}
					else = {
						activate_law = law_type:law_scholar_bureaucrats
						add_journal_entry = {
							type = je_scholar_bureaucrats
						}
					}
				}
				else = {
					activate_law = PREV
				}
			}
		}

		if = {
			limit = { has_modifier = eafp_modi_gunmin_dongchi_antiwestern_coup }
			remove_modifier = eafp_modi_gunmin_dongchi_antiwestern_coup
		}
		recalculate_pop_ig_support = yes

		every_political_movement = {
			limit = {
				has_modifier = eafp_modi_gunmin_dongchi_antiwestern_coup_movement
			}
			remove_modifier = eafp_modi_gunmin_dongchi_antiwestern_coup_movement
		}

		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
	}

    timeout = 3650

    on_timeout = {
        trigger_event = { id = gunmin_dongchi_events.102 popup = yes }
		
		custom_tooltip = je_gunmin_dongchi_antiwestern_coup_on_fail_tt
		every_in_list = {
			limit = { ROOT = { NOT = { has_law = PREV } } }
			variable = gunmin_dongchi_initial_lawtype_varlist

			ROOT = {
				if = {
					limit = { PREV = law_type:law_scholar_bureaucrats }
					if = {
						limit = {
							NOT = { has_law_or_variant = law_type:law_state_religion }
							NOT = { has_law_or_variant = law_type:law_peasant_levies }
							NOT = { has_law_or_variant = law_type:law_serfdom }
						}
						activate_law = law_type:law_appointed_bureaucrats
					}
					else = {
						activate_law = law_type:law_scholar_bureaucrats
						add_journal_entry = {
							type = je_scholar_bureaucrats
						}
					}
				}
				else = {
					activate_law = PREV
				}
			}
		}

		if = {
			limit = { has_modifier = eafp_modi_gunmin_dongchi_antiwestern_coup }
			remove_modifier = eafp_modi_gunmin_dongchi_antiwestern_coup
		}
		recalculate_pop_ig_support = yes

		every_political_movement = {
			limit = {
				has_modifier = eafp_modi_gunmin_dongchi_antiwestern_coup_movement
			}
			remove_modifier = eafp_modi_gunmin_dongchi_antiwestern_coup_movement
		}

		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
    }

	invalid = {
		NOT = { has_law_or_variant = law_type:law_monarchy }
	}

	on_invalid = {
		hidden_effect = {
			gunmin_dongchi_clean_effect = yes
		}
	}

	on_weekly_pulse = {
		effect = {
			gunmin_dongchi_var_update_effect = yes
		}
	}

    weight = 1000
    should_be_pinned_by_default = yes
}

je_korean_reclamation = {
    icon = "gfx/interface/icons/event_icons/event_map.dds"

    group = je_group_internal_affairs

    is_shown_when_inactive = {
        c:KOR ?= this
    }

	possible = {
		c:KOR ?= this
		owns_entire_state_region = STATE_SEOUL
		owns_entire_state_region = STATE_PYONGYANG
		owns_entire_state_region = STATE_YANGHO
		has_technology_researched = steel_frame_buildings
		has_technology_researched = concrete_fortifications
		has_technology_researched = dynamite
	}

    complete = {
        s:STATE_SEOUL.region_state:KOR = {
			has_building = building_korean_reclamation
		}
		s:STATE_PYONGYANG.region_state:KOR = {
			has_building = building_korean_reclamation
		}
		s:STATE_YANGHO.region_state:KOR = {
			has_building = building_korean_reclamation
		}
    }

    on_complete = {
		every_state = {
			limit = { has_building = building_korean_reclamation }
			remove_building = building_korean_reclamation
		}
        s:STATE_SEOUL = {
			add_arable_land = 5
		}
		s:STATE_PYONGYANG = {
			add_arable_land = 12
		}
		s:STATE_YANGHO = {
			add_arable_land = 18
		}
    }

	fail = {
		NAND = {
			owns_entire_state_region = STATE_SEOUL
			owns_entire_state_region = STATE_PYONGYANG
			owns_entire_state_region = STATE_YANGHO
		}
	}

	on_fail = {
		every_state = {
			limit = { has_building = building_korean_reclamation }
			remove_building = building_korean_reclamation
		}
	}

    weight = 1000
    should_be_pinned_by_default = no
}

je_gando_ambition = {
	icon = "gfx/interface/icons/event_icons/event_map.dds"

    group = je_group_foreign_affairs

    is_shown_when_inactive = {
        c:KOR ?= ROOT
    }

	possible = {
		c:KOR ?= ROOT
		owns_entire_state_region = STATE_SEOUL
		owns_entire_state_region = STATE_PYONGYANG
		owns_entire_state_region = STATE_SARIWON
		is_subject = no
		has_technology_researched = pan-nationalism
		custom_tooltip = {
			text = je_korean_land_problem_complete_cond_tt
			has_variable = eafp_var_sam_all_clear
		}
		c:CHI ?= {
			country_or_subject_owns_entire_state_region = STATE_SOUTHERN_MANCHURIA
		}
		NOT = {
			custom_tooltip = {
				text = china_shatters_tt
				has_global_variable = china_shatters
			}
		}
	}

	immediate = {
		c:CHI = {
			save_scope_as = china_scope
		}
	}

    complete = {
        
    }

    on_complete = {
		
    }

	fail = {
		NAND = {
			c:KOR ?= ROOT
			owns_entire_state_region = STATE_SEOUL
			owns_entire_state_region = STATE_PYONGYANG
			owns_entire_state_region = STATE_SARIWON
			is_subject = no
			has_technology_researched = pan-nationalism
			custom_tooltip = {
				text = je_korean_land_problem_complete_cond_tt
				has_variable = eafp_var_sam_all_clear
			}
			c:CHI ?= {
				country_or_subject_owns_entire_state_region = STATE_SOUTHERN_MANCHURIA
			}
			NOT = {
				custom_tooltip = {
					text = china_shatters_tt
					has_global_variable = china_shatters
				}
			}
		}
	}

	timeout = 7300

    weight = 1000
    should_be_pinned_by_default = no
}