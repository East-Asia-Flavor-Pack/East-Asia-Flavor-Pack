namespace = chi_flavor

chi_flavor.1 = { # 황위의 계승 - 시스템 상 자연사
	type = country_event
	placement = ROOT

	title = chi_flavor.1.t
	desc = chi_flavor.1.d

	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/misc/1Character_Banner"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
		ruler = { save_scope_as = new_emperor }
		if = {
			limit = {
				scope:former_emperor = { has_variable = is_Yizhu_Aisin_Gioro }
			}
			trigger_event = {
				id = chi_flavor.102
				months = { 1 3 }
			}
		}
	}

	option = {
		name = chi_flavor.1.a
		default_option = yes
		
		ai_chance = {
			base = 100
		}
	}
}

chi_flavor.101 = { # 황위의 계승 - 함풍제 즉위
	type = character_event
	hidden = yes
	
	immediate = {
		if = {
			limit = { has_variable = is_Daoguang_Aisin_Gioro }
			kill_character = yes
		}
	}
}

chi_flavor.102 = { # 황위의 계승 - 동치제 즉위 - 아마
	type = character_event
	hidden = yes
	
	immediate = {
		if = {
			limit = { has_modifier = old_summer_palace_destroyed_ruler_modifier }
			kill_character = yes
		}
	}
}

chi_flavor.2 = { # 1851년 황하 대개도
	type = country_event
	placement = ROOT

	title = chi_flavor.2.t
	desc = chi_flavor.2.d

	duration = 3

	event_image = {
		video = "gfx/event_pictures/china/flood.bik"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/destruction"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
		s:STATE_HENAN.region_state:CHI = { save_scope_as = henan_scope }
		s:STATE_SHANDONG.region_state:CHI = { save_scope_as = shandong_scope }
	}

	option = {
		name = chi_flavor.2.a
		default_option = yes
		
		custom_tooltip = natural_disaster_variable_tt

		hidden_effect = {
			random_list = {
				20 = {
					trigger = {
						exists = s:STATE_HENAN.region_state:CHI
					}
					s:STATE_HENAN.region_state:CHI = {
						set_variable = {
							name = natural_disaster_variable
							months = short_modifier_time
						}
					}
				}
				20 = {
					trigger = {
						exists = s:STATE_ZHILI.region_state:CHI
					}
					s:STATE_ZHILI.region_state:CHI = {
						set_variable = {
							name = natural_disaster_variable
							months = short_modifier_time
						}
					}
				}
				50 = {
					trigger = {
						exists = s:STATE_SHANDONG.region_state:CHI
					}
					s:STATE_SHANDONG.region_state:CHI = {
						set_variable = {
							name = natural_disaster_variable
							months = short_modifier_time
						}
					}
				}
				10 = {
				}
			}
		}

		s:STATE_HENAN = {
			add_devastation = 35
		}
		s:STATE_ZHILI = {
			add_devastation = 35
		}
		s:STATE_SHANDONG = {
			add_devastation = 70
		}
		
		s:STATE_BEIJING.region_state:CHI = {
			remove_modifier = grand_canal
		}
		s:STATE_ZHEJIANG.region_state:CHI = {
			remove_modifier = grand_canal
		}
		s:STATE_JIANGSU.region_state:CHI = {
			remove_modifier = grand_canal
		}
		s:STATE_NANJING.region_state:CHI = {
			remove_modifier = grand_canal
		}
		s:STATE_ZHILI.region_state:CHI = {
			remove_modifier = grand_canal
		}
		s:STATE_SHANDONG.region_state:CHI = {
			remove_modifier = grand_canal
		}
		s:STATE_SUZHOU.region_state:CHI = {
			remove_modifier = grand_canal
		}
		
		ai_chance = {
			base = 100
		}
	}
}

chi_flavor.3 = { # 원명원 파괴
	type = country_event
	placement = ROOT

	title = chi_flavor.3.t
	desc = chi_flavor.3.d
	flavor = chi_flavor.3.f

	duration = 3

	event_image = {
		video = "gfx/event_pictures/china/flood.bik"
	}

	trigger = {
		s:STATE_BEIJING.region_state:CHI = { exists = yes }
		NOT = { s:STATE_BEIJING.region_state:CHI.controller = c:CHI }
		NOT = { has_variable = summer_palace_destroyed }
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/destruction"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
		s:STATE_BEIJING.region_state:CHI.controller = { save_scope_as = occupying_country }
	}

	option = {
		name = chi_flavor.3.a
		default_option = yes
		
		hidden_effect = {
			ruler = {
				add_modifier = {
					name = old_summer_palace_destroyed_ruler_modifier
				}
				trigger_event = {
					id = chi_flavor.102
					years = { 3 5 }
				}
			}
			set_variable = summer_palace_destroyed
			trigger_event = {
				id = chinese_westernization.1
				years = { 5 7 }
			}
		}
		
		ai_chance = {
			base = 100
		}
	}
}

chi_flavor.4 = { # 1851년 황하 대개도
	type = country_event
	placement = ROOT

	title = chi_flavor.4.t
	desc = chi_flavor.4.d
	flavor = chi_flavor.4.f

	duration = 3

	event_image = {
		video = "gfx/event_pictures/china/flood.bik"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/destruction"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
		s:STATE_HENAN.region_state:CHI = { save_scope_as = henan_scope }
		s:STATE_SHANDONG.region_state:CHI = { save_scope_as = shandong_scope }
	}

	option = {
		name = chi_flavor.4.a
		default_option = yes
		
		custom_tooltip = natural_disaster_variable_tt

		hidden_effect = {
			random_list = {
				20 = {
					trigger = {
						exists = s:STATE_HENAN.region_state:CHI
					}
					s:STATE_HENAN.region_state:CHI = {
						set_variable = {
							name = natural_disaster_variable
							months = short_modifier_time
						}
					}
				}
				55 = {
					trigger = {
						exists = s:STATE_NORTHERN_ANHUI.region_state:CHI
					}
					s:STATE_NORTHERN_ANHUI.region_state:CHI = {
						set_variable = {
							name = natural_disaster_variable
							months = short_modifier_time
						}
					}
				}
				10 = {
					trigger = {
						exists = s:STATE_JIANGSU.region_state:CHI
					}
					s:STATE_JIANGSU.region_state:CHI = {
						set_variable = {
							name = natural_disaster_variable
							months = short_modifier_time
						}
					}
				}
				5 = {
					trigger = {
						exists = s:STATE_NANJING.region_state:CHI
					}
					s:STATE_NANJING.region_state:CHI = {
						set_variable = {
							name = natural_disaster_variable
							months = short_modifier_time
						}
					}
				}
				10 = {
				}
			}
		}

		s:STATE_HENAN = {
			add_devastation = 40
		}
		s:STATE_NORTHERN_ANHUI = {
			add_devastation = 100
		}
		s:STATE_JIANGSU = {
			add_devastation = 10
		}
		s:STATE_NANJING = {
			add_devastation = 10
		}
		
		ai_chance = {
			base = 100
		}
	}
}

chi_flavor.9 = { # 만국공법
	type = country_event
	placement = ROOT

	title = chi_flavor.9.t
	desc = chi_flavor.9.d
	flavor = chi_flavor.9.f

	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	trigger = {
		
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
		
	}

	option = {
		name = chi_flavor.9.a
		default_option = yes
		
		ai_chance = {
			base = 100
		}
	}
}

chi_flavor.10 = { # 만주와 한 (민족주의 연구 시 TODO)
	type = country_event
	placement = ROOT

	title = chi_flavor.10.t
	desc = chi_flavor.10.d
	flavor = chi_flavor.10.f

	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	trigger = {
		has_technology_progress = { technology = nationalism progress > 0 }
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
		
	}

	option = {
		name = chi_flavor.10.a
		default_option = yes

		remove_primary_culture = cu:han
		
		ai_chance = {
			base = 100
		}
	}
}