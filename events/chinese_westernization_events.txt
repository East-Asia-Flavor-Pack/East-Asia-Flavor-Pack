namespace = chinese_westernization

#################### 중국 서구화 시작 ####################
chinese_westernization.1 = {
	type = country_event
	placement = root

	title = chinese_westernization.1.t
	desc = chinese_westernization.1.d
	flavor = chinese_westernization.1.f
	
	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
		NOT = { has_journal_entry = je_chinese_westernization }
		# chi_flavor.3 터지고 5~7년 뒤 시작
		# 또는 적당히 시간 지난 다음에 하던가 - TODO
	}

	immediate = {
		
	}

	option = {
		name = chinese_westernization.1.a
		default_option = yes
		add_journal_entry = { type = je_chinese_westernization }
		hidden_effect = {
			trigger_event = { id = chinese_westernization.401 months = 4 }
		}
		ai_chance = {
			base = 1
		}
	}
}

#################### 육군 ####################

chinese_westernization.101 = { # 의용부대의 등장
	type = country_event
	placement = root

	title = chinese_westernization.101.t
	desc = chinese_westernization.101.d
	
	duration = 1

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_military.dds"

	trigger = {
		exists = c:TPG
	}

	immediate = {
		set_variable = chi_the_emergence_of_militias
	}

	option = {
		name = chinese_westernization.101.a
		default_option = yes

		custom_tooltip = chinese_westernization.101.tt

		ai_chance = {
			base = 1
		}
	}
	after = {
		chiwes302
	}
}

chinese_westernization.102 = { # (도시 이름) 병공창
	type = country_event
	placement = scope:first_modern_arsenal_state

	title = chinese_westernization.102.t
	desc = chinese_westernization.102.d
	flavor = chinese_westernization.102.f
	
	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
		this = c:CHI
		NOT = { has_variable = chi_first_modern_arsenal }
		any_scope_building = {
			# is_building_type = building_arms_industry
			has_active_production_method = pm_rifles
			is_under_construction = no
		}
	}

	immediate = {
		set_variable = chi_first_modern_arsenal
		save_scope_as = chi_scope
		random_scope_building = {
			limit = {
				# is_building_type = building_arms_industry
				has_active_production_method = pm_rifles
				is_under_construction = no
			}
			save_scope_as = first_modern_arsenal
			state = { save_scope_as = first_modern_arsenal_state }
		}
	}

	option = {
		name = chinese_westernization.102.a
		scope:first_modern_arsenal = {
			add_modifier = {
				name = chi_first_modern_arsenal
				months = long_modifier_time
				is_decaying = yes
			}
		}
		default_option = yes
		ai_chance = {
			base = 1
		}
	}
}

chinese_westernization.121 = { # (도시 이름) 무비학당 설립 시도
	type = country_event
	placement = scope:military_academy_state

	title = {
		first_valid = {
			triggered_desc = {
				desc = chinese_westernization.121.t1
				trigger = { scope:military_academy_state = { is_coastal = yes } }
			}
			triggered_desc = {
				desc = chinese_westernization.121.t2
				trigger = { always = yes }
			}
		}
	}
	desc = {
		first_valid = {
			triggered_desc = {
				desc = chinese_westernization.121.d1
				trigger = { scope:military_academy_state = { is_coastal = yes } }
			}
			triggered_desc = {
				desc = chinese_westernization.121.d2
				trigger = { always = yes }
			}
		}
	}
	flavor = chinese_westernization.121.f
	
	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
		# je_chi_military_academy로 트리거
	}

	immediate = {
		save_scope_as = chi_scope
	}

	option = {
		name = chinese_westernization.121.a
		default_option = yes
		ai_chance = {
			base = 1
		}
	}
}

chinese_westernization.122 = { # 반발
	type = country_event
    placement = scope:military_academy_state

    title = chinese_westernization.122.t
    desc = {
		first_valid = {
			triggered_desc = {
				desc = chinese_westernization.122.d1
				trigger = { scope:military_academy_state = { is_coastal = yes } }
			}
			triggered_desc = {
				desc = chinese_westernization.122.d2
				trigger = { always = yes }
			}
		}
	}
    flavor = chinese_westernization.122.f

    duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	
	trigger = {
		
	}
	
	immediate = {
		
	}

	option = {
		name = chinese_westernization.122.a
		add_medium_peril_effect = yes
		expedition_moderate_progress_effect = yes
	}

	option = {
		name = chinese_westernization.122.b
		default_option = yes
		add_small_peril_effect = yes
		custom_tooltip = expedition_event_delayed_tt
	}

	option = {
		name = chinese_westernization.122.c
		custom_tooltip = {
			text = chi_military_academy_fail_tt
			change_variable = {
				name = chi_military_academy_peril
				add = 8
			}
		}
	}
}



# 천진무비학당 1885년

# 무비학당 설립에 대한 기존 장군들의 반발

chinese_westernization.199 = { # 육군의 완전한 현대화
	type = country_event
	placement = root

	title = chinese_westernization.199.t
	desc = chinese_westernization.199.d
	flavor = chinese_westernization.199.f
	
	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
	}

	immediate = {
	}

	option = {
		name = chinese_westernization.199.a
		default_option = yes
		ai_chance = {
			base = 1
		}
	}
}

#################### 해군 ####################

chinese_westernization.201 = { # (항구 이름) 조선소 (steamship 1868년)
	type = country_event
	placement = scope:first_modern_shipyard_state

	title = chinese_westernization.201.t
	desc = chinese_westernization.201.d
	flavor = chinese_westernization.201.f
	
	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
		this = c:CHI
		NOT = { has_variable = chi_first_modern_shipyard }
		any_scope_building = {
			# is_building_type = building_shipyards
			has_active_production_method = pm_metal_shipbuilding
			is_under_construction = no
		}
	}

	immediate = {
		set_variable = chi_first_modern_shipyard
		save_scope_as = chi_scope
		random_scope_building = {
			limit = {
				# is_building_type = building_shipyards
				has_active_production_method = pm_metal_shipbuilding
				is_under_construction = no
			}
			save_scope_as = first_modern_shipyard
			state = { save_scope_as = first_modern_shipyard_state }
		}
	}

	option = {
		name = chinese_westernization.201.a
		scope:first_modern_shipyard = {
			add_modifier = {
				name = chi_first_modern_shipyard
				months = long_modifier_time
				is_decaying = yes
			}
		}
		default_option = yes
		ai_chance = {
			base = 1
		}
	}
}

# 복주선정국 (복주선정학당) 1866년

# 천진수사학당 1881년

# 해외 유학

# 북양군벌

# 상해. 남경, 천진, 복주, 광주, 한구

#################### 산업 ####################

chinese_westernization.301 = { # 최초의 철도
	type = country_event
	placement = scope:first_railroad_state

	title = chinese_westernization.301.t
	desc = chinese_westernization.301.d
	flavor = chinese_westernization.301.f
	
	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
		this = c:CHI
		NOT = { has_variable = chi_first_railroad }
		any_scope_building = {
			is_building_type = building_railway
			is_under_construction = no
		}
	}

	immediate = {
		set_variable = chi_first_railroad
		save_scope_as = chi_scope
		random_scope_building = {
			limit = {
				is_building_type = building_railway
				is_under_construction = no
			}
			save_scope_as = first_railroad
			state = { save_scope_as = first_railroad_state }
		}
		if = {
			limit = { NOT = { has_variable = chiwes302 } }
			set_variable = chiwes302
		}
	}

	option = {
		name = chinese_westernization.301.a
		scope:first_railroad = {
			add_modifier = {
				name = chi_first_railroad
				months = long_modifier_time
				is_decaying = yes
			}
		}
		default_option = yes
		ai_chance = {
			base = 1
		}
	}
}

chinese_westernization.302 = { # 철도 공포
	type = country_event
	placement = root

	title = chinese_westernization.302.t
	desc = chinese_westernization.302.d
	flavor = chinese_westernization.302.f
	
	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
		this = c:CHI
		NOT = { has_variable = chiwes302 }
		any_scope_building = {
			is_building_type = building_railway
			is_under_construction = yes
		}
	}

	immediate = {
		set_variable = chiwes302
		save_scope_as = chi_scope
		random_scope_building = {
			limit = {
				is_building_type = building_railway
				is_under_construction = yes
			}
			state = { save_scope_as = first_railroad_state }
		}
	}

	option = {
		name = chinese_westernization.302.a
		default_option = yes
		# TODO - 철도 건설 못 하게 막기
		ai_chance = {
			base = 0.8
		}
	}

	option = {
		name = chinese_westernization.302.b
		add_modifier = {
			name = chiwes302b
			is_decaying = yes
			years = 3
		}
		ai_chance = {
			base = 0.2
		}
	}
}

chinese_westernization.303 = { # (광산 이름) 광산 (개평광산 1881년)
	type = country_event
	placement = scope:first_modern_mine_state

	title = chinese_westernization.303.t
	desc = chinese_westernization.303.d
	flavor = chinese_westernization.303.f
	
	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
		this = c:CHI
		NOT = { has_variable = chi_first_modern_mine }
		any_scope_building = {
			OR = {
				has_active_production_method = pm_condensing_engine_pump_building_coal_mine
				has_active_production_method = pm_condensing_engine_pump_building_iron_mine
				has_active_production_method = pm_condensing_engine_pump_building_lead_mine
				has_active_production_method = pm_condensing_engine_pump_building_sulfur_mine
            }
		}
	}

	immediate = {
		set_variable = chi_first_modern_mine
		save_scope_as = chi_scope
		random_scope_building = {
			limit = {
				OR = {
					has_active_production_method = pm_condensing_engine_pump_building_coal_mine
					has_active_production_method = pm_condensing_engine_pump_building_iron_mine
					has_active_production_method = pm_condensing_engine_pump_building_lead_mine
					has_active_production_method = pm_condensing_engine_pump_building_sulfur_mine
				}
				is_under_construction = no
			}
			save_scope_as = first_modern_mine
			state = { save_scope_as = first_modern_mine_state }
		}
	}

	option = {
		name = chinese_westernization.303.a
		scope:first_modern_mine = {
			add_modifier = {
				name = chi_first_modern_mine
				months = long_modifier_time
				is_decaying = yes
			}
		}
		default_option = yes
		ai_chance = {
			base = 1
		}
	}
}




# 윤선초상국 (주식회사, 조선소)

# Shanghai Cotton Cloth Mill 1878년

#################### 정부 개혁 ####################

chinese_westernization.401 = { # 총리아문의 설립
	type = country_event
	placement = root

	title = chinese_westernization.401.t
	desc = chinese_westernization.401.d
	
	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	option = {
		name = chinese_westernization.401.a
		default_option = yes
		ai_chance = {
			base = 1
		}
	}
}

# Tongwen Guan, 양무학당

#################### 국제적 위상 ####################

# 만국공법