# ID명, 변수명은 기본적으로 일본어 음차합니다.
# weight = 12000 최중요저널 10000 중요저널 8000 일반 5000 별 의미없음

# 막번체제

je_bakuhantaisei = {
	icon = "gfx/interface/icons/alert_icons/revolution.dds"

	group = je_group_bakuhantaisei

	scripted_progress_bar = bakuhantaisei_bakufu_authority_progress_bar

	scripted_button = appoint_tairo_button

	immediate = {
		
	}

	status_desc = {
		first_valid = {
			triggered_desc = { 
				desc = je_bakuhantaisei_desc_start
				trigger = {
					scope:journal_entry = {
						"scripted_bar_progress(bakuhantaisei_bakufu_authority_progress_bar)" >= 3600
					}
				}
			}
			triggered_desc = { 
				desc = je_bakuhantaisei_desc_very_low
				trigger = {
					scope:journal_entry = {
						"scripted_bar_progress(bakuhantaisei_bakufu_authority_progress_bar)" >= 3200
					}
				}
			}
			triggered_desc = { 
				desc = je_bakuhantaisei_desc_low
				trigger = {
					scope:journal_entry = {
						"scripted_bar_progress(bakuhantaisei_bakufu_authority_progress_bar)" >= 2400
					}
				}
			}
			triggered_desc = { 
				desc = je_bakuhantaisei_desc_medium
				trigger = {
					scope:journal_entry = {
						"scripted_bar_progress(bakuhantaisei_bakufu_authority_progress_bar)" >= 1600
					}
				}
			}
			triggered_desc = { 
				desc = je_bakuhantaisei_desc_high
				trigger = {
					scope:journal_entry = {
						"scripted_bar_progress(bakuhantaisei_bakufu_authority_progress_bar)" >= 800
					}
				}
			}
			desc = je_bakuhantaisei_desc_very_high
		}
	}

	complete = { 
		custom_tooltip = {
			text = je_bakuhantaisei_complete_tt
			has_variable = bakufu_kaikaku_complete_var
		}
	}

	on_complete = { 
		# TODO
		trigger_event = {
			id = eafp_japan.666 #임시
		}
	}

	fail = {
		scope:journal_entry = {
			"scripted_bar_progress(bakuhantaisei_bakufu_authority_progress_bar)" <= 0
		}
	}

	on_fail = {
		# TODO
		custom_tooltip = {
			text = boshin_war_je_add_tt
			if = {
				limit = { 
					NAND = { 
						exists = c:NIP
						has_war_with = c:NIP
					}
				}
				#create_diplomatic_play = {
				#	target_country = c:NIP
				#	type = dp_annex_war
				#	escalation = 80
				#	add_war_goal = { holder = c:NIP target_country = c:JAP type = annex_country }
				#}
				hidden_effect = {	 
					change_infamy = -200
				}
			}
			add_journal_entry = {
				type = japan_boshin_war_je
			}
		}
	}

	on_yearly_pulse = {
		effect = {
			every_scope_character = { # 막부 정치인이기만 한 인물 사망 판정정
				limit = {
					has_variable = eafp_bakuhantaisei_politician_influence
					is_busy = yes # immortal 판정 trigger는 없음. (원래)

					trigger_if = {
						limit = { modifier:character_health_add >= 1 }
						age >= {
							value = define:NCharacters|CHARACTER_LIFE_EXPECTANCY_BASE_YEARS
							add = var:CHARACTER_LIFE_EXPECTANCY_STDDEV_value
							add = {
								value = modifier:character_health_add
								add = -1
								multiply = define:NCharacters|CHARACTER_LIFE_EXPECTANCY_DELTA_YEARS_ABOVE_BASELINE
							}
						}
					}
					trigger_else = {
						age >= {
							value = define:NCharacters|CHARACTER_LIFE_EXPECTANCY_BASE_YEARS
							add = var:CHARACTER_LIFE_EXPECTANCY_STDDEV_value
							add = {
								value = modifier:character_health_add
								add = -1
								multiply = define:NCharacters|CHARACTER_LIFE_EXPECTANCY_DELTA_YEARS_BELOW_BASELINE
							}
						}
					}
				}
				trigger_event = {
					id = eafp_japan.6
					days = { 30 364 }
				}
			}
		}
	}
	
	transferable = yes

	weight = 12000

	should_be_pinned_by_default = yes
}

je_bakuhantaisei_TOHOKU = {
	icon = "gfx/interface/icons/law_icons/land_based_taxation.dds"

	group = je_group_bakuhantaisei

	scripted_progress_bar = bakuhantaisei_TOHOKU_loyalty_progress_bar
	scripted_progress_bar = bakuhantaisei_TOHOKU_independency_progress_bar
	scripted_progress_bar = bakuhantaisei_TOHOKU_goryo_progress_bar

	scripted_button = expand_goryo_TOHOKU_button
	scripted_button = reduce_goryo_TOHOKU_button
	scripted_button = show_bakufu_authority_TOHOKU_button
	scripted_button = forced_tokorogae_TOHOKU_button

	scripted_button = reduce_nidome_TOHOKU_button
	scripted_button = reduce_nidome2_TOHOKU_button

	immediate = {
		
	}

	on_weekly_pulse = {
		effect = {
			je_bakuhantaisei_STATE_weekly_pulse = { STATE = TOHOKU }
		}
	}

	progress_desc = je_bakuhantaisei_TOHOKU_progress

	transferable = yes

	weight = 10000

	should_be_pinned_by_default = no
}
je_bakuhantaisei_KANTO = {
	icon = "gfx/interface/icons/law_icons/land_based_taxation.dds"

	group = je_group_bakuhantaisei

	scripted_progress_bar = bakuhantaisei_KANTO_loyalty_progress_bar
	scripted_progress_bar = bakuhantaisei_KANTO_independency_progress_bar
	scripted_progress_bar = bakuhantaisei_KANTO_goryo_progress_bar

	scripted_button = expand_goryo_KANTO_button
	scripted_button = reduce_goryo_KANTO_button
	scripted_button = show_bakufu_authority_KANTO_button
	scripted_button = forced_tokorogae_KANTO_button

	scripted_button = reduce_nidome_KANTO_button
	scripted_button = reduce_nidome2_KANTO_button

	immediate = {
		
	}

	on_weekly_pulse = {
		effect = {
			je_bakuhantaisei_STATE_weekly_pulse = { STATE = KANTO }
		}
	}

	progress_desc = je_bakuhantaisei_KANTO_progress

	transferable = yes

	weight = 10000

	should_be_pinned_by_default = no
}
je_bakuhantaisei_CHUBU = {
	icon = "gfx/interface/icons/law_icons/land_based_taxation.dds"

	group = je_group_bakuhantaisei

	scripted_progress_bar = bakuhantaisei_CHUBU_loyalty_progress_bar
	scripted_progress_bar = bakuhantaisei_CHUBU_independency_progress_bar
	scripted_progress_bar = bakuhantaisei_CHUBU_goryo_progress_bar

	scripted_button = expand_goryo_CHUBU_button
	scripted_button = reduce_goryo_CHUBU_button
	scripted_button = show_bakufu_authority_CHUBU_button
	scripted_button = forced_tokorogae_CHUBU_button

	scripted_button = reduce_nidome_CHUBU_button
	scripted_button = reduce_nidome2_CHUBU_button

	immediate = {
		
	}

	on_weekly_pulse = {
		effect = {
			je_bakuhantaisei_STATE_weekly_pulse = { STATE = CHUBU }
		}
	}

	progress_desc = je_bakuhantaisei_CHUBU_progress

	transferable = yes

	weight = 10000

	should_be_pinned_by_default = no
}
je_bakuhantaisei_KANSAI = {
	icon = "gfx/interface/icons/law_icons/land_based_taxation.dds"

	group = je_group_bakuhantaisei

	scripted_progress_bar = bakuhantaisei_KANSAI_loyalty_progress_bar
	scripted_progress_bar = bakuhantaisei_KANSAI_independency_progress_bar
	scripted_progress_bar = bakuhantaisei_KANSAI_goryo_progress_bar

	scripted_button = expand_goryo_KANSAI_button
	scripted_button = reduce_goryo_KANSAI_button
	scripted_button = show_bakufu_authority_KANSAI_button
	scripted_button = forced_tokorogae_KANSAI_button

	scripted_button = reduce_nidome_KANSAI_button
	scripted_button = reduce_nidome2_KANSAI_button

	immediate = {
		
	}

	on_weekly_pulse = {
		effect = {
			je_bakuhantaisei_STATE_weekly_pulse = { STATE = KANSAI }
		}
	}

	progress_desc = je_bakuhantaisei_KANSAI_progress

	transferable = yes

	weight = 10000

	should_be_pinned_by_default = no
}
je_bakuhantaisei_KYUSHU = {
	icon = "gfx/interface/icons/law_icons/land_based_taxation.dds"

	group = je_group_bakuhantaisei

	scripted_progress_bar = bakuhantaisei_KYUSHU_loyalty_progress_bar
	scripted_progress_bar = bakuhantaisei_KYUSHU_independency_progress_bar
	scripted_progress_bar = bakuhantaisei_KYUSHU_goryo_progress_bar

	scripted_button = expand_goryo_KYUSHU_button
	scripted_button = reduce_goryo_KYUSHU_button
	scripted_button = show_bakufu_authority_KYUSHU_button
	scripted_button = forced_tokorogae_KYUSHU_button

	scripted_button = reduce_nidome_KYUSHU_button
	scripted_button = reduce_nidome2_KYUSHU_button

	immediate = {
		
	}

	on_weekly_pulse = {
		effect = {
			je_bakuhantaisei_STATE_weekly_pulse = { STATE = KYUSHU }
		}
	}

	progress_desc = je_bakuhantaisei_KYUSHU_progress

	transferable = yes

	weight = 10000

	should_be_pinned_by_default = no
}
je_bakuhantaisei_CHUGOKU = {
	icon = "gfx/interface/icons/law_icons/land_based_taxation.dds"

	group = je_group_bakuhantaisei

	scripted_progress_bar = bakuhantaisei_CHUGOKU_loyalty_progress_bar
	scripted_progress_bar = bakuhantaisei_CHUGOKU_independency_progress_bar
	scripted_progress_bar = bakuhantaisei_CHUGOKU_goryo_progress_bar

	scripted_button = expand_goryo_CHUGOKU_button
	scripted_button = reduce_goryo_CHUGOKU_button
	scripted_button = show_bakufu_authority_CHUGOKU_button
	scripted_button = forced_tokorogae_CHUGOKU_button

	scripted_button = reduce_nidome_CHUGOKU_button
	scripted_button = reduce_nidome2_CHUGOKU_button

	immediate = {
		
	}

	on_weekly_pulse = {
		effect = {
			je_bakuhantaisei_STATE_weekly_pulse = { STATE = CHUGOKU }
		}
	}

	progress_desc = je_bakuhantaisei_CHUGOKU_progress

	transferable = yes

	weight = 10000

	should_be_pinned_by_default = no
}
je_bakuhantaisei_SHIKOKU = {
	icon = "gfx/interface/icons/law_icons/land_based_taxation.dds"

	group = je_group_bakuhantaisei

	scripted_progress_bar = bakuhantaisei_SHIKOKU_loyalty_progress_bar
	scripted_progress_bar = bakuhantaisei_SHIKOKU_independency_progress_bar
	scripted_progress_bar = bakuhantaisei_SHIKOKU_goryo_progress_bar

	scripted_button = expand_goryo_SHIKOKU_button
	scripted_button = reduce_goryo_SHIKOKU_button
	scripted_button = show_bakufu_authority_SHIKOKU_button
	scripted_button = forced_tokorogae_SHIKOKU_button

	scripted_button = reduce_nidome_SHIKOKU_button
	scripted_button = reduce_nidome2_SHIKOKU_button

	immediate = {
		
	}

	on_weekly_pulse = {
		effect = {
			je_bakuhantaisei_STATE_weekly_pulse = { STATE = SHIKOKU }
		}
	}

	progress_desc = je_bakuhantaisei_SHIKOKU_progress

	transferable = yes

	weight = 10000

	should_be_pinned_by_default = no
}

# 홋카이도

je_hokkaido = {
	icon = "gfx/interface/icons/law_icons/frontier_colonization.dds"

	group = je_group_historical_content

	scripted_progress_bar = hokkaido_progress_bar

	immediate = {
		s:STATE_HOKKAIDO.region_state:JAP = {
			add_modifier = disorganized_bashoukeoisei_modifier
			add_modifier = matsumae_han_modifier
		}
	}

	complete = {
		s:STATE_HOKKAIDO.region_state:JAP.state_population >= 200000
		scope:journal_entry = { is_goal_complete = yes }
	}

	on_complete = {
		trigger_event = {
			id = eafp_japan.1000
		}
		custom_tooltip = {
			text = hokkaido_complete_tt
			set_variable = hokkaido_name_var
		}
	}

	on_monthly_pulse = {
		random_events = {
			1 = hokkaido.5
			1 = hokkaido.5
			22 = 0
		}
	}

	timeout = 7000

	weight = 8000

}

# 텐포 대기근

je_tenpo_famine = {
	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	group = je_group_historical_content

	immediate = {
		every_scope_state = {
			limit = {
				NOT = { state_region = s:STATE_TOHOKU }
				NOT = { state_region = s:STATE_KYUSHU }
				NOT = { state_region = s:STATE_HOKKAIDO }
			}
			add_modifier = {
				name = modifier_crop_failure_tenpo
				multiplier = 2
			}
		}
		s:STATE_TOHOKU.region_state:JAP = {
			add_modifier = {
				name = modifier_crop_failure_tenpo
				multiplier = 3
			}
		}
		s:STATE_KYUSHU.region_state:JAP = {
			add_modifier = modifier_crop_failure_tenpo
		}
		# 이미 구호소 운영중
		set_variable = {
			name = sukuigoya_for_tenpo
			value = 2
		}
		add_modifier = {
			name = modifier_sukuigoya_for_tenpo
			multiplier = var:sukuigoya_for_tenpo
		}
		set_variable = {
			name = sukuigoya_for_tenpo_accumulation
			value = 0
		}
		trigger_event = {
			id = tenpo_famine.2
			months = 1
		}
		trigger_event = {
			id = tenpo_famine.5
			days = 448 # 1년 83일
		}
	}

	scripted_progress_bar = tenpo_famine_progress_bar

	scripted_button = install_sukuigoya_button
	scripted_button = expand_sukuigoya_button
	scripted_button = close_sukuigoya_button
	scripted_button = reduce_sukuigoya_button

	status_desc = je_tenpo_famine_status

	on_monthly_pulse = {
		effect = {
			if = {
				limit = { has_variable = sukuigoya_for_tenpo }
				change_variable = {
					name = sukuigoya_for_tenpo_accumulation
					add = var:sukuigoya_for_tenpo
				}
			}
		}
		random_events = {
			chance_of_no_event = {
				value = 2
				if = {
					limit = { has_variable = sukuigoya_for_tenpo }
					add = var:sukuigoya_for_tenpo
				}
			}
			1 = 0
			1 = tenpo_famine.4
		}
	}

	complete = {
		custom_tooltip = {
			text = je_tenpo_famine_complete
			scope:journal_entry = { 
				"scripted_bar_progress(tenpo_famine_progress_bar)" >= 72
			}
		}
	}

	on_complete = {
		trigger_event = tenpo_famine.99
	}

	weight = 10000
	should_be_pinned_by_default = yes
}

# 막부 개혁

je_bakufu_kaikaku = {
	icon = "gfx/interface/icons/objectives/egalitarian_society.dds"

	group = je_group_historical_content

	scripted_progress_bar = bakufu_kaikaku_progress_bar
	scripted_progress_bar = bakufu_kaikaku_hitotsubashiha_approval_progress_bar
	scripted_progress_bar = bakufu_kaikaku_nankiha_approval_progress_bar

	scripted_button = japan_kaikakuha_button
	scripted_button = japan_hoshuha_button
	
	scripted_button = repeal_ikokusen_uchiharairei_button
	scripted_button = reenact_ikokusen_uchiharairei_button

	scripted_button = bakufu_seisaku_new_currency_start_button
	scripted_button = bakufu_seisaku_junochisui_start_button
	scripted_button = bakufu_seisaku_agechirei_start_button
	scripted_button = bakufu_seisaku_kokishukusei_start_button


	#scripted_button = japan_bakufu_kaikaku_button
	#scripted_button = japan_hitotsubashiha_phase_1_button
	#scripted_button = japan_hitotsubashiha_phase_2_button
	#scripted_button = japan_hitotsubashiha_phase_3_button
	
	status_desc = {
		
	}

	progress_desc = {
		first_valid = {
			
		}
	}

	immediate = {
		set_variable = { 
			name = hitotsubashiha_var # 개혁파 변수
			value = 10
		}
		set_variable = { 
			name = nankiha_var # 보수파 변수
			value = 90
		}
		weekly_pulse_bakufu_kaikaku_progress_bar_faction = yes
	}

	

	complete = { 
		OR = {
			custom_tooltip = {
				text = bakufu_kaikaku_je_complete_1_tt
				has_variable = no_boshin_war_var
			}
			custom_tooltip = {
				text = bakufu_kaikaku_je_complete_2_tt
				has_variable = boshin_war_bakufu_win_var
			}
		}
		custom_tooltip = {
			text = bakufu_kaikaku_zaisei_clear
			has_variable = bakufu_kaikaku_zaisei_complete_var
		}
		custom_tooltip = {
			text = bakufu_kaikaku_kaikoku_clear
			has_variable = bakufu_kaikaku_kaikoku_complete_var
		}
		custom_tooltip = {
			text = bakufu_kaikaku_guntai_clear
			has_variable = bakufu_kaikaku_guntai_complete_var
		}
		custom_tooltip = {
			text = bakufu_kaikaku_naibu_clear
			has_variable = bakufu_kaikaku_naibu_complete_var
		}
		custom_tooltip = {
			text = bakufu_kaikaku_bakuhan_clear
			has_variable = bakufu_kaikaku_bakuhan_complete_var
		}
		remove_variable = hitotsubashiha_var_monthly_add
		remove_variable = nankiha_var_monthly_add
	}

	on_complete = { 
		if = {
			limit = { has_variable = is_nankiha }
			trigger_event = { id = eafp_japan.666 }
		}
		else_if = {
			limit = { has_variable = is_hitotsubashiha }
			trigger_event = { id = eafp_japan.666 }
		}
		else = {
			custom_tooltip = {
				text = unknown_tt
			}
		}
	}

	on_monthly_pulse = {
		effect = {
			change_variable = { name = hitotsubashiha_var add = var:hitotsubashiha_var_monthly_add } 
			change_variable = { name = nankiha_var add = var:nankiha_var_monthly_add } 
			bakufu_kaikaku_progress_bar_calc = yes
		}
	}

	on_weekly_pulse = {
		effect = {
			weekly_pulse_bakufu_kaikaku_progress_bar_faction = yes
		}
	}

	weight = 12000

	should_be_pinned_by_default = yes
}

japan_bakufu_kaikoku_je = {
	icon = "gfx/interface/icons/goods_icons/man_o_wars.dds"

	group = je_group_historical_content

	complete = { 
		OR = {
			custom_tooltip = {
				text = treaty_with_powers
				has_variable = complete_treaty_with_powers_var
			}
			AND = {
				NOT = {
					has_law = law_type:law_isolationism
					has_law = law_type:law_traditionalism
					has_law = law_type:law_closed_borders
				}
			}
		}
	}

	on_complete = { 
		custom_tooltip = {
			text = complete_kaikaku
			set_variable = bakufu_kaikaku_kaikoku_complete_var
		}
		if = {
			limit = { has_variable = is_nankiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = nankiha_var
					add = 100
				}
			}
		}
		else_if = {
			limit = { has_variable = is_hitotsubashiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = hitotsubashiha_var
					add = 100
				}
			}
		}
		else = {
			custom_tooltip = {
				text = hahatsu_unknown
			}
		}
		remove_modifier = bakufu_corruption_dip
		add_modifier = {
			name = bakufu_kaikoku_complete
			months = 60
		}
	}

	weight = 10000
}

japan_bakufu_guntai_je = {
	icon = "gfx/interface/icons/war_goals/conquer_state.dds"

	group = je_group_historical_content

	complete = { 
		army_size >= 100
		navy_size >= 10
		has_technology_researched = napoleonic_warfare
		OR = {
			NOT = {
				any_scope_building = {
					is_building_type = building_barracks				
					OR = {
						building_has_goods_shortage = yes
						has_active_production_method = pm_no_organization
					}
				}
			}
			NOT = {
				any_military_formation = {
					filter = {
						is_army = yes
					}
					any_combat_unit = {
						has_unit_type = unit_type:combat_unit_type_irregular_infantry
					}
					percent >= 0.25
				}
			}
		}
		any_scope_building = { 
			is_building_type = building_arms_industry
			OR = {
				has_active_production_method = pm_rifles
				has_active_production_method = pm_repeaters
				has_active_production_method = pm_bolt_action_rifles
			}
			level >= 5
			occupancy >= 0.75
		}
	}

	on_complete = { 
		custom_tooltip = {
			text = complete_kaikaku
			set_variable = bakufu_kaikaku_kaikoku_complete_var
		}
		if = {
			limit = { has_variable = is_nankiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = nankiha_var
					add = 100
				}
			}
		}
		else_if = {
			limit = { has_variable = is_hitotsubashiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = hitotsubashiha_var
					add = 100
				}
			}
		}
		else = {
			custom_tooltip = {
				text = hahatsu_unknown
			}
		}
		remove_modifier = bakufu_corruption_mil
		add_modifier = {
			name = bakufu_guntai_complete
			months = 60
		}
		add_modifier = {
			name = bakufu_guntai_complete_2
			months = 36
		}
	}

	weight = 10000
}

japan_bakufu_bakuhan_je = {
	icon = "gfx/interface/icons/war_goals/conquer_state.dds"

	group = je_group_historical_content

	complete = { 
		OR = {
			# TODO 번들이 ㅈㄴ 싫어하는 상태
			owns_entire_state_region = STATE_KANTO
			owns_entire_state_region = STATE_KANSAI
			owns_entire_state_region = STATE_TOHOKU
			owns_entire_state_region = STATE_HOKKAIDO
			owns_entire_state_region = STATE_CHUBU
			owns_entire_state_region = STATE_CHUGOKU
			owns_entire_state_region = STATE_SHIKOKU
			owns_entire_state_region = STATE_KYUSHU
			is_at_war = no
		}
		custom_tooltip = {
			text = boshin_war_start
			has_variable = boshin_war_var
		}
	}

	on_complete = { 
		custom_tooltip = {
			text = complete_kaikaku
			set_variable = bakufu_kaikaku_bakuhan_complete_var
		}
		if = {
			limit = { has_variable = is_nankiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = nankiha_var
					add = 100
				}
			}
		}
		else_if = {
			limit = { has_variable = is_hitotsubashiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = hitotsubashiha_var
					add = 100
				}
			}
		}
		else = {
			custom_tooltip = {
				text = hahatsu_unknown
			}
		}
		remove_modifier = bakufu_corruption_bakuhan
	}

	weight = 10000
}

japan_bakufu_guntai_je = {
	icon = "gfx/interface/icons/war_goals/conquer_state.dds"

	group = je_group_historical_content

	complete = { 
		army_size >= 100
		navy_size >= 10
		has_technology_researched = napoleonic_warfare
		NOR = {
			any_scope_building = {
				is_building_type = building_barracks				
				OR = {
					building_has_goods_shortage = yes
					has_active_production_method = pm_no_organization
				}
			}
			any_military_formation = {
				filter = {
					is_army = yes
				}
				any_combat_unit = {
					has_unit_type = unit_type:combat_unit_type_irregular_infantry
				}
				percent >= 0.25
			}
		}
		any_scope_building = { 
			is_building_type = building_arms_industry
			OR = {
				has_active_production_method = pm_rifles
				has_active_production_method = pm_repeaters
				has_active_production_method = pm_bolt_action_rifles
			}
			level >= 5
			occupancy >= 0.75
		}
	}

	on_complete = { 
		custom_tooltip = {
			text = complete_kaikaku
			set_variable = bakufu_kaikaku_guntai_complete_var
		}
		if = {
			limit = { has_variable = is_nankiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = nankiha_var
					add = 100
				}
			}
		}
		else_if = {
			limit = { has_variable = is_hitotsubashiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = hitotsubashiha_var
					add = 100
				}
			}
		}
		else = {
			custom_tooltip = {
				text = hahatsu_unknown
			}
		}
		remove_modifier = bakufu_corruption_mil
		add_modifier = {
			name = bakufu_guntai_complete
			months = 60
		}
		add_modifier = {
			name = bakufu_guntai_complete_2
			months = 36
		}
	}

	weight = 10000

}

japan_bakufu_naibu_je = {
	icon = "gfx/interface/icons/pops_icons/bureaucrats.dds"

	group = je_group_historical_content

	immediate = {
		set_variable = {
			name = shogunate_var
			value = 0
		}
	}

	complete = { 
		scope:journal_entry = { is_goal_complete = yes }
		ig:ig_landowners = {
			is_in_government = yes
		}
		government_legitimacy >= 80
		bureaucracy >= 0
		any_scope_building = {
			is_building_type = building_university
			occupancy > 0.9
			level >= 5
		}
		literacy_rate >= 0.25
	}

	on_complete = { 
		custom_tooltip = {
			text = complete_kaikaku
			set_variable = bakufu_kaikaku_naibu_complete_var
		}
		if = {
			limit = { has_variable = is_nankiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = nankiha_var
					add = 100
				}
			}
		}
		else_if = {
			limit = { has_variable = is_hitotsubashiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = hitotsubashiha_var
					add = 100
				}
			}
		}
		else = {
			custom_tooltip = {
				text = hahatsu_unknown
			}
		}
		remove_modifier = bakufu_corruption_adm
		add_modifier = {
			name = bakufu_naibu_complete
			months = 60
		}
	}

	on_monthly_pulse = {
		effect = {
			if = {
				limit = {
					ig:ig_landowners = {
						is_in_government = yes
					}
					has_insurrectionary_interest_groups = no
					is_at_war = no
				}
				change_variable = {
					name = shogunate_var
					add = 1
				}
			}
		}
	}

	current_value = {
		value = root.var:shogunate_var
	}

	goal_add_value = {
		value = 120
	}

	weight = 10000

	
}

japan_bakufu_zaisei_je = {
	icon = "gfx/interface/icons/event_icons/event_industry.dds"

	group = je_group_historical_content

	complete = { 
		scope:journal_entry = {
			is_goal_complete = yes
		}
		average_sol >= 10
		gold_reserves > 0
		s:STATE_KANTO.region_state:JAP = {
			filter = {
				is_incorporated = yes
			}
			any_scope_building = {
				is_building_type = building_urban_center
				level >= 8
			}
		}
	}

	on_complete = { 
		custom_tooltip = {
			text = complete_kaikaku
			set_variable = bakufu_kaikaku_zaisei_complete_var
		}
		if = {
			limit = { has_variable = is_nankiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = nankiha_var
					add = 100
				}
			}
		}
		else_if = {
			limit = { has_variable = is_hitotsubashiha }
			custom_tooltip = {
				text = bakufu_point_increase
				change_variable = {
					name = hitotsubashiha_var
					add = 100
				}
			}
		}
		else = {
			custom_tooltip = {
				text = hahatsu_unknown
			}
		}
		remove_modifier = bakufu_corruption_fin
		add_modifier = {
			name = bakufu_zaisei_complete
			months = 60
		}
	}

	current_value = {
		value = root.gdp
	}

	goal_add_value = {
		value = root.gdp
		multiply = 0.5
	}

	progressbar = yes
	weight = 10000

}

#막부 

japan_boshin_war_je = {

	icon = "gfx/interface/icons/ig_icons/armed_forces.dds"

	group = je_group_historical_content

	complete = {
		owns_entire_state_region = STATE_KYUSHU
		owns_entire_state_region = STATE_KANSAI
		owns_entire_state_region = STATE_CHUGOKU
		owns_entire_state_region = STATE_SHIKOKU
		owns_entire_state_region = STATE_CHUBU
		owns_entire_state_region = STATE_KANTO
		NOT = { exists = c:NIP }
		
	}

	timeout = 666

	on_weekly_pulse = {
		effect = {
		   if = {
				limit = { 
					ruler = { has_template = eafp_tokugawa_yoshinobu }
					c:NIP.army_size >= { value = root.army_size multiply = 0.75 }
				}
				trigger_event = { id = boshin_war.9 }
			}
		}
	}

	weight = 20000

	should_be_pinned_by_default = yes
}


#도막파

je_tobaku_boshin_war = {
	icon = "gfx/interface/icons/ig_icons/armed_forces.dds"

	group = je_group_historical_content
   
	scripted_button = japan_tobaku_1_button
	scripted_button = japan_tobaku_2_button
	scripted_button = japan_tobaku_3_button
	scripted_button = japan_tobaku_4_button
	scripted_button = japan_tobaku_5_button

	complete = {
		owns_entire_state_region = STATE_KYUSHU
		owns_entire_state_region = STATE_KANSAI
		owns_entire_state_region = STATE_CHUGOKU
		owns_entire_state_region = STATE_SHIKOKU
		owns_entire_state_region = STATE_CHUBU
		owns_entire_state_region = STATE_KANTO
		custom_tooltip = { 
			text = sento_tt
			OR = {
				has_variable = sento_tokyo
				has_variable = sento_shinai
			}
		}
	}

	on_complete = {
		trigger_event = {
			id = new_meiji.1
		}
		change_tag = JAP
		if = { 
			limit = { has_variable = sento_tokyo }
			set_capital = STATE_KANTO
		}
		if = { 
			limit = { has_variable = sento_shinai }
			set_capital = STATE_KANSAI
		}
		set_variable = meiji_var
	}

	weight = 20000

	should_be_pinned_by_default = yes
}


je_meiji_ishin = {
	icon = "gfx/interface/icons/ig_icons/armed_forces.dds"

	group = je_group_historical_content
   
	immediate = {
		set_variable = {
			name = meiji_ishin_var
			value = 0
		}
	}

	complete = {
		is_country_type = recognized
		country_rank >= rank_value:major_power
		custom_tooltip = {
			text = kenpo_ready_tt
			has_variable = meiji_kenpo
		}
		custom_tooltip = {
			text = meiji_ishin_clear_tt
			root.var:meiji_ishin_var = 4
		}
	}

	on_complete = {
		custom_tooltip = {
			text = dainippon_teikoku_tt
			set_global_variable = meiji_ishin_clear_var
		}
	}

	on_monthly_pulse = {
		effect = {
			random_list = {
				150 = { }
				1 = { 
					trigger_event = { id = new_meiji.4 days = { 5 140 } } #남북조 정윤론 논쟁
				}
			}
		}
	}

	weight = 20000

	should_be_pinned_by_default = yes
}


je_meiji_politics = {
	icon = "gfx/interface/icons/ig_icons/armed_forces.dds"

	group = je_group_historical_content
   
	
	 
	immediate = {
		set_variable = {
			name = meiji_ishin_politics_var
			value = 0
		}
	}

	complete = {
		custom_tooltip = {
			text = meiji_ishin_politics_clear_tt
			root.var:meiji_ishin_politics_var = 4
		}
		has_revolution = no
	}

	on_complete = { #모디파이어 넣어야함
		change_variable = {
			name = meiji_ishin_var
			add = 1
		}
	}

	weight = 18000

}

je_meiji_diplomacy_1 = {
	icon = "gfx/interface/icons/ig_icons/armed_forces.dds"

	group = je_group_historical_content
   
	immediate = {
		set_variable = {
			name = meiji_ishin_diplomacy_var
			value = 0
		}
	}

	complete = {
		custom_tooltip = {
			text = meiji_ishin_diplomacy_clear_tt
			root.var:meiji_ishin_diplomacy_var >= 5
		}
		army_size >= 100
		navy_size >= 20
	}

	on_complete = { #이벤트 넣어야함
		change_variable = {
			name = meiji_ishin_var
			add = 1
		}
		set_country_type = recognized
	}

	weight = 18000
}

je_meiji_diplomacy_2 = {
	icon = "gfx/interface/icons/ig_icons/armed_forces.dds"

	group = je_group_historical_content
   
	immediate = {
		set_variable = {
			name = jap_recognition_progress_var
			value = 0
		}
	}

	complete = {
		scope:journal_entry = {
			is_goal_complete = yes
		}
		NOT = { has_law = law_type:law_land_based_taxation }
		NOT = { has_law = law_type:law_serfdom }
		NOT = { has_law = law_type:law_isolationism }
		NOT = { has_law = law_type:law_traditionalism }
		NOT = { has_law = law_type:law_closed_borders }
		any_country = {
			country_rank >= rank_value:great_power
			relations:root >= relations_threshold:friendly
		}
	}

	on_complete = { #이벤트 넣어야함
		change_variable = {
			name = meiji_ishin_var
			add = 1
		}
		set_country_type = recognized
	}

	on_monthly_pulse = {
		effect = {
			# Wargoal enforced scores are handled in the on_wargoal_enforced on_action
			# Advance Conditions
			if = {
				limit = {
					# Your GDP per Capita is relatively high
					gdp_per_capita_ranking <= 20
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = 1
				}
			}
			if = {
				limit = {
					# Your Standard of Living is relatively high
					sol_ranking <= 20
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = 1
				}
			}			
			if = {
				limit = {
					# Country has voting rights
					country_has_voting_franchise = yes
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = 1
				}
			}
			if = {
				limit = {
					# Literacy rating is high-isch
					literacy_rate >= 0.6
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = 1
				}
			}
			# Deplete Conditions
			if = {
				limit = {
					# Slavery is legal
					NOT = {
						has_law = law_type:law_slavery_banned
					}
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = -1
				}
			}
			if = {
				limit = {
					# Serfdom is legal
					has_law = law_type:law_serfdom
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = -1
				}
			}
			if = {
				limit = {
					# Traditional economic system
					has_law = law_type:law_traditionalism
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = -1
				}
			}
			if = {
				limit = {
					# 'Draconic' law
					has_law = law_type:law_outlawed_dissent
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = -1
				}
			}
			if = {
				limit = {
					# Literacy rating is low
					literacy_rate <= 0.4
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = -1
				}
			}
			if = {
				limit = {
					# Your GDP per Capita is relatively low
					gdp_per_capita_ranking >= 50
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = -1
				}
			}
			if = {
				limit = {
					# Your Standard of Living is relatively low
					sol_ranking >= 50
				}
				change_variable = {
					name = jap_recognition_progress_var
					add = -1
				}
			}
			clamp_variable = { name = jap_recognition_progress_var max = 200 min = 0 }
		}
	}

	current_value = {
		value = root.var:jap_recognition_progress_var
	}

	goal_add_value = {
		value = 200
	}

	progressbar = yes
	
	weight = 18000
}

je_meiji_economy_2 = {
	icon = "gfx/interface/icons/ig_icons/armed_forces.dds"

	group = je_group_historical_content
   
	immediate = {
		set_variable = {
			name = meiji_ishin_economy_2_var
			value = 0
		}
	}

	complete = {
		scope:journal_entry = {
			is_goal_complete = yes
		}
		custom_tooltip = {
			text = meiji_ishin_economy_2_clear_tt
			root.var:meiji_ishin_economy_2_var = 5
		}
		in_default = no
		any_scope_state = {
			filter = {
				is_incorporated = yes
			}
			any_scope_building = {
				is_building_type = building_urban_center
				level >= 10
			}
			has_building = building_railway
			percent > 0.6
		}
	}

	on_complete = { #이벤트 넣어야함
		change_variable = {
			name = meiji_ishin_var
			add = 1
		}
	}

	current_value = {
		value = root.gdp
	}

	goal_add_value = {
		value = root.gdp
		multiply = 1
	}

	progressbar = yes

	weight = 18000

}

je_meiji_society = {
	icon = "gfx/interface/icons/ig_icons/armed_forces.dds"

	group = je_group_historical_content
   
	immediate = {
		set_variable = {
			name = meiji_ishin_society_var
			value = 0
		}
	}

	complete = {
		custom_tooltip = {
			text = meiji_ishin_society_clear_tt
			root.var:meiji_ishin_society_var = 10
		}
		institution_investment_level = {
			institution = institution_schools
			value >= 3
		}
	}

	on_complete = { #이벤트 넣어야함
		change_variable = {
			name = meiji_ishin_var
			add = 1
		}
	}

	on_monthly_pulse = {
		effect = {
			random_events = {
				100 = 0
				5 = meiji_society.1 #태양력
				5 = meiji_society.2 #평민 이름 개정
				5 = meiji_society.3 #도량형 도입
			}
		}
	}


	weight = 18000

}