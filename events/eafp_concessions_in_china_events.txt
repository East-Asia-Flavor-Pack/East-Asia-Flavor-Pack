namespace = concessions_in_china

#################### 조계지 계산 ####################
# 중국 측 이벤트
concessions_in_china.1 = {
	type = country_event
	hidden = yes

	trigger = {
		any_scope_state = {
			has_variable_list = concession_owner_varlist
		}
	}

	immediate = {
		# 혁명 주 처리
		every_scope_state = {
			limit = {
				has_variable_list = concession_owner_varlist
				is_split_state = yes
				owner = { has_revolution = yes }
				state_region = { 
					any_scope_state = {
						is_treaty_port = no
						owner = { is_revolutionary = yes }
						NOT = { has_variable_list = concession_owner_varlist }
					}
				}
			}
			save_scope_as = temp_state
			state_region = { 
				every_scope_state = {
					limit = {
						is_treaty_port = no
						owner = { is_revolutionary = yes }
						NOT = { has_variable_list = concession_owner_varlist }
					}
					save_scope_as = temp_state2
					scope:temp_state = {
						every_in_list = {
							variable = concession_owner_varlist
							scope:temp_state2 = {
								add_to_variable_list = { name = concession_owner_varlist target = PREV }
							}
						}
					}
					clear_saved_scope = temp_state2
				}
			}
			clear_saved_scope = temp_state
		}
		# 조계지 배당금 계산
		set_variable = {
			name = concession_payment_var
			value = 0
		}
		every_scope_state = {
			limit = {
				has_variable_list = concession_owner_varlist
			}
			set_local_variable = {
				name = concession_owner_varlist_size
				value = 0
			}
			every_in_list = {
				variable = concession_owner_varlist
				change_local_variable = {
					name = concession_owner_varlist_size
					add = 1
				}
			}
			set_local_variable = {
				name = concession_payment_locvar
				value = 0
			}
			if = { limit = { has_modifier = concession_state_modifier } remove_modifier = concession_state_modifier }
			add_modifier = {
				name = concession_state_modifier
				multiplier = {
					value = local_var:concession_owner_varlist_size
					max = 4 # 최대 40%
				}
				days = 30
			}
			every_scope_building = {
				# 무역소
				if = {
					limit = { is_building_type = building_trade_center }
					remove_modifier = concession_building_modifier
					set_local_variable = {
						name = shares_sum
						value = {
							value = modifier:building_workforce_shares_add
							add = modifier:building_government_shares_add
							add = modifier:building_aristocrats_shares_add
							add = modifier:building_bureaucrats_shares_add
							add = modifier:building_capitalists_shares_add
							add = modifier:building_clergymen_shares_add
							add = modifier:building_clerks_shares_add
							add = modifier:building_engineers_shares_add
							add = modifier:building_farmers_shares_add
							add = modifier:building_peasants_shares_add
							add = modifier:building_laborers_shares_add
							add = modifier:building_officers_shares_add
							add = modifier:building_academics_shares_add
							add = modifier:building_shopkeepers_shares_add
							add = modifier:building_slaves_shares_add
							add = modifier:building_soldiers_shares_add
							add = modifier:building_machinists_shares_add
						}
					}
					add_modifier = {
						name = concession_building_modifier
						multiplier = {
							value = local_var:shares_sum
							divide = {
								value = 5 # = (1/20%), 나라당 20%만큼 뜯김
								divide = {
									value = local_var:concession_owner_varlist_size
									max = 4 # 최대 80%
								}
								subtract = 1
							}
						}
						days = 30
					}
					change_local_variable = {
						name = concession_payment_locvar
						add = {
							value = weekly_profit
							multiply = 0.20 # 20%
							multiply = {
								value = local_var:concession_owner_varlist_size
								max = 4
							}
							multiply = 4.286 # 주 -> 달
						}
					}
					ROOT = {
						change_variable = {
							name = concession_payment_var
							add = local_var:concession_payment_locvar
						}
					}
					remove_local_variable = shares_sum
				}
				# 도심지
				if = {
					limit = { is_building_type = building_urban_center }
					remove_modifier = concession_building_modifier
					set_local_variable = {
						name = shares_sum
						value = {
							value = modifier:building_workforce_shares_add
							add = modifier:building_government_shares_add
							add = modifier:building_aristocrats_shares_add
							add = modifier:building_bureaucrats_shares_add
							add = modifier:building_capitalists_shares_add
							add = modifier:building_clergymen_shares_add
							add = modifier:building_clerks_shares_add
							add = modifier:building_engineers_shares_add
							add = modifier:building_farmers_shares_add
							add = modifier:building_peasants_shares_add
							add = modifier:building_laborers_shares_add
							add = modifier:building_officers_shares_add
							add = modifier:building_academics_shares_add
							add = modifier:building_shopkeepers_shares_add
							add = modifier:building_slaves_shares_add
							add = modifier:building_soldiers_shares_add
							add = modifier:building_machinists_shares_add
						}
					}
					add_modifier = {
						name = concession_building_modifier
						multiplier = {
							value = local_var:shares_sum
							divide = {
								value = 6.67 # = (1/15%), 나라당 15%만큼 뜯김
								divide = {
									value = local_var:concession_owner_varlist_size
									max = 4 # 최대 60%
								}
								subtract = 1
							}
						}
						days = 30
					}
					change_local_variable = {
						name = concession_payment_locvar
						add = {
							value = weekly_profit
							multiply = 0.15 # 15%
							multiply = {
								value = local_var:concession_owner_varlist_size
								max = 4
							}
							multiply = 4.286 # 주 -> 달
						}
					}
					ROOT = {
						change_variable = {
							name = concession_payment_var
							add = local_var:concession_payment_locvar
						}
					}
					remove_local_variable = shares_sum
				}
				# 공장 & 인프라
				if = {
					limit = {
						OR = {
							is_building_group = bg_infrastructure
							is_building_group = bg_manufacturing
						}
					}
					remove_modifier = concession_building_modifier
					set_local_variable = {
						name = shares_sum
						value = {
							value = modifier:building_workforce_shares_add
							add = modifier:building_government_shares_add
							add = modifier:building_aristocrats_shares_add
							add = modifier:building_bureaucrats_shares_add
							add = modifier:building_capitalists_shares_add
							add = modifier:building_clergymen_shares_add
							add = modifier:building_clerks_shares_add
							add = modifier:building_engineers_shares_add
							add = modifier:building_farmers_shares_add
							add = modifier:building_peasants_shares_add
							add = modifier:building_laborers_shares_add
							add = modifier:building_officers_shares_add
							add = modifier:building_academics_shares_add
							add = modifier:building_shopkeepers_shares_add
							add = modifier:building_slaves_shares_add
							add = modifier:building_soldiers_shares_add
							add = modifier:building_machinists_shares_add
						}
					}
					add_modifier = {
						name = concession_building_modifier
						multiplier = {
							value = local_var:shares_sum
							divide = {
								value = 10 # = (1/10%), 나라당 10%만큼 뜯김
								divide = {
									value = local_var:concession_owner_varlist_size
									max = 4 # 최대 40%
								}
								subtract = 1
							}
						}
						days = 30
					}
					change_local_variable = {
						name = concession_payment_locvar
						add = {
							value = weekly_profit
							multiply = 0.10 # 10%
							multiply = {
								value = local_var:concession_owner_varlist_size
								max = 4
							}
							multiply = 4.286 # 주 -> 달
						}
					}
					ROOT = {
						change_variable = {
							name = concession_payment_var
							add = local_var:concession_payment_locvar
						}
					}
					remove_local_variable = shares_sum
				}
			}
			remove_local_variable = concession_payment_locvar
			remove_local_variable = concession_owner_varlist_size
		}
		every_in_list = {
			variable = concession_owner_varlist
			if = {
				limit = { NOT = { has_variable = concession_paid_var } }
				set_variable = {
					name = concession_paid_var
					value = 0
				}
			}
			change_variable = {
				name = concession_paid_var
				add = {
					value = local_var:concession_payment_locvar
					divide = local_var:concession_owner_varlist_size
				}
			}
		}
		every_country = { trigger_event = concessions_in_china.2 }
		if = { limit = { has_modifier = concession_payment } remove_modifier = concession_payment }
		add_modifier = {
			name = concession_payment
			multiplier = var:concession_payment_var
		}
		remove_variable = concession_payment_var
	}
}

# 상대 측 이벤트
concessions_in_china.2 = { # 대체 왜 안됨?
	type = country_event
	hidden = yes

	trigger = {
		has_variable = concession_paid_var
	}

	immediate = {
		add_modifier = {
			name = concession_paid
			days = 30
			multiplier = var:concession_paid_var
		}
		remove_variable = concession_paid_var
	}
}

#################### 조계지 이벤트 ####################
# 조계지 설치 시에는 상대측 이벤트 다 띄우고 중국 측 이벤트 띄움
# 조계지 제거 시에는 중국측 이벤트 다 띄우고 상대 측 이벤트 띄움
# scope:concession_target_country : 중국 (여러 중국에서 제거 시 없음)
# scope:concession_owner_country : 상대 (여러 상대가 설치 시 없음)
# scope:concession_gain_country_num : 조계지 설치되는 중국 국가 수 (설치 시)
# scope:concession_loss_country_num : 조계지 빼앗기는 상대 국가 수 (제거 시)
# 가능한 경우 : 여러 상대가 동시에 한 중국에게서 조계 획득, 여러 중국이 동시에 한 상대에게서 조계 탈환
# on action
# 조계지 설치 (상대)
concessions_in_china.1001 = {
	type = country_event
	placement = ROOT

	title = concessions_in_china.1001.t
	desc = concessions_in_china.1001.d
	flavor = concessions_in_china.1001.f
	
	duration = 1

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
	}

	immediate = {
		scope:concession_target_country = {
			random_scope_state = {
				limit = {
					state_is_in_china_proper = yes
					is_treaty_port = no
					NOT = { is_target_in_variable_list = { name = concession_owner_varlist target = ROOT } }
				}
				weight = {
					base = 1
					modifier = {
						total_urbanization >= 5
						add = 1
					}
					modifier = {
						total_urbanization >= 10
						add = 1
					}
					modifier = {
						total_urbanization >= 15
						add = 1
					}
					modifier = {
						total_urbanization >= 20
						add = 1
					}
					modifier = {
						total_urbanization >= 25
						add = 1
					}
					modifier = {
						total_urbanization >= 30
						add = 1
					}
					modifier = {
						total_urbanization >= 35
						add = 1
					}
					modifier = {
						total_urbanization >= 40
						add = 1
					}
					modifier = {
						total_urbanization >= 45
						add = 1
					}
					modifier = {
						total_urbanization >= 50
						add = 1
					}
					modifier = {
						total_urbanization >= 55
						add = 1
					}
					modifier = {
						total_urbanization >= 60
						add = 1
					}

					modifier = { # 1.2배씩
						arable_land <= 100
						factor = 0.833
					}
					modifier = {
						arable_land <= 120
						factor = 0.833
					}
					modifier = {
						arable_land <= 144
						factor = 0.833
					}
					modifier = {
						arable_land <= 172
						factor = 0.833
					}
					modifier = {
						arable_land <= 207
						factor = 0.833
					}
					modifier = {
						arable_land <= 248
						factor = 0.833
					}
					modifier = {
						arable_land <= 298
						factor = 0.833
					}
					modifier = {
						arable_land <= 358
						factor = 0.833
					}
					modifier = {
						arable_land <= 429
						factor = 0.833
					}
					modifier = {
						arable_land <= 515
						factor = 0.833
					}
					modifier = {
						arable_land <= 619
						factor = 0.833
					}
					# 서구화 시작하면 북경 우선
					modifier = {
						scope:concession_target_country = {
							OR = {
								has_journal_entry = je_chinese_westernization
								has_variable = chinese_westernization_complete
							}
						}
						state_region = s:STATE_BEIJING
						factor = 100
					}
					# 아니면 숙주 우선
					modifier = {
						scope:concession_target_country = {
							NOR = {
								has_journal_entry = je_chinese_westernization
								has_variable = chinese_westernization_complete
							}
						}
						state_region = s:STATE_SUZHOU
						factor = 100
					}
					# 북경, 숙주
					modifier = {
						OF = {
							state_region = s:STATE_BEIJING
							state_region = s:STATE_SUZHOU
						}
						factor = 10000
					}
					# 홍콩 소유국이 소주
					modifier = {
						ROOT = {
							any_scope_state = {
								state_region = s:STATE_SHAOZHOU
								is_treaty_port = yes
							}
						}
						state_region = s:STATE_SHAOZHOU
						factor = 100
					}
					# 한커우 (동 호북)
					modifier = {
						state_region = s:STATE_EASTERN_HUBEI
						factor = 2.5
					}
					# 광저우 (광동)
					modifier = {
						state_region = s:STATE_GUANGDONG
						factor = 2
					}
					# 남 안휘
					modifier = {
						state_region = s:STATE_SOUTHERN_ANHUI
						factor = 1.3
					}
					# 절강
					modifier = {
						state_region = s:STATE_ZHEJIANG
						factor = 1.6
					}
					# 서 호북
					modifier = {
						state_region = s:STATE_WESTERN_HUBEI
						factor = 1.3
					}
					# 중경
					modifier = {
						state_region = s:STATE_CHONGQING
						factor = 1.3
					}
					# 그 외
					# 해안가
					modifier = {
						is_coastal = yes
						factor = 2
					}
					# 장강과 주강
					modifier = {
						OR = {
							has_state_trait = state_trait_yangtze_river
							has_state_trait = state_trait_pearl_river
						}
						factor = 3
					}
				}
				save_scope_as = concession_target_state
				add_to_variable_list = { name = concession_owner_varlist target = ROOT }
				scope:concession_target_state.state_region = {
					save_scope_as = concession_state_region
					concession_state_status_calc_scope = yes
				}
			}
		}

		if = {
			limit = { NOT = { has_journal_entry = je_concessions_in_china2 } }
			add_journal_entry = { type = je_concessions_in_china2 }
		}
	}

	option = {
		name = concessions_in_china.1001.a
		default_option = yes
		
		ai_chance = {
			base = 1
		}
	}
}

# 조계지 설치 (중국)
concessions_in_china.1002 = {
	type = country_event
	placement = ROOT

	title = concessions_in_china.1002.t
	desc = {
		first_valid = {
			triggered_desc = {
				desc = concessions_in_china.1002.d1
				trigger = { scope:concession_gain_country_num = 1 }
			}
			desc = concessions_in_china.1002.d2
		}
	}
	flavor = {
		first_valid = {
			triggered_desc = {
				desc = concessions_in_china.1002.f1
				trigger = { scope:concession_gain_country_num = 1 }
			}
			desc = concessions_in_china.1002.f2
		}
	}

	duration = 1

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
	}

	immediate = {
		if = {
			limit = { NOT = { has_journal_entry = je_concessions_in_china } }
			add_journal_entry = { type = je_concessions_in_china }
		}
	}

	option = {
		name = concessions_in_china.1002.a
		default_option = yes
		
		trigger = {
			scope:concession_gain_cause = 1
		}

		ai_chance = {
			base = 1
		}
	}

	option = {
		name = concessions_in_china.1002.b
		default_option = yes
		
		trigger = {
			scope:concession_gain_cause = 2
		}

		ai_chance = {
			base = 1
		}
	}
}

# 조계지 설치 (상대)
concessions_in_china.1003 = {
	type = country_event
	placement = ROOT

	title = concessions_in_china.1003.t
	desc = concessions_in_china.1003.d
	flavor = concessions_in_china.1003.f
	
	duration = 1

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
	}

	immediate = {
	}

	option = {
		name = concessions_in_china.1003.a
		default_option = yes
		
		trigger = {
			scope:concession_loss_cause = 1
		}

		ai_chance = {
			base = 1
		}
	}

	option = {
		name = concessions_in_china.1003.b
		default_option = yes
		
		trigger = {
			scope:concession_loss_cause = 2
		}

		ai_chance = {
			base = 1
		}
	}
}

# 조계지 반환 (중국)
concessions_in_china.1004 = {
	type = country_event
	placement = ROOT

	title = concessions_in_china.1004.t
	desc = concessions_in_china.1004.d
	flavor = concessions_in_china.1004.f
	
	duration = 1

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
	}

	immediate = {
		if = {
			limit = {
				any_scope_state = {
					is_target_in_variable_list = { name = concession_owner_varlist target = scope:concession_owner_country }
				}
			}
			random_scope_state = {
				limit = {
					is_target_in_variable_list = { name = concession_owner_varlist target = scope:concession_owner_country }
				}
				# 조계지 생성 가중치의 역수
				weight = {
					base = 1
					modifier = {
						arable_land >= 50
						add = 1
					}
					modifier = {
						arable_land >= 100
						add = 1
					}
					modifier = {
						arable_land >= 150
						add = 1
					}
					modifier = {
						arable_land >= 200
						add = 1
					}
					modifier = {
						arable_land >= 250
						add = 1
					}
					modifier = {
						arable_land >= 300
						add = 1
					}
					modifier = {
						arable_land >= 350
						add = 1
					}
					modifier = {
						arable_land >= 400
						add = 1
					}
					modifier = {
						arable_land >= 450
						add = 1
					}
					modifier = {
						arable_land >= 500
						add = 1
					}
					modifier = {
						arable_land >= 550
						add = 1
					}
					modifier = {
						arable_land >= 600
						add = 1
					}

					modifier = {
						total_urbanization = 0
						factor = 100
					}
					modifier = {
						total_urbanization = 1
						factor = 6
					}
					modifier = {
						total_urbanization = 2
						factor = 3
					}
					modifier = {
						total_urbanization = 3
						factor = 2
					}
					modifier = {
						total_urbanization = 4
						factor = 1.5
					}
					modifier = {
						total_urbanization <= 6
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 7
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 8
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 10
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 12
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 14
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 17
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 21
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 25
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 30
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 37
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 44
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 53
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 64
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 77
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 98
						factor = 1.2
					}
					modifier = {
						total_urbanization <= 110
						factor = 1.2
					}
					# 서구화 시작하면 북경 우선
					modifier = {
						scope:concession_target_country = {
							OR = {
								has_journal_entry = je_chinese_westernization
								has_variable = chinese_westernization_complete
							}
						}
						state_region = s:STATE_BEIJING
						factor = 0.01
					}
					# 아니면 숙주 우선
					modifier = {
						scope:concession_target_country = {
							NOR = {
								has_journal_entry = je_chinese_westernization
								has_variable = chinese_westernization_complete
							}
						}
						state_region = s:STATE_SUZHOU
						factor = 0.01
					}
					# 북경, 숙주
					modifier = {
						OF = {
							state_region = s:STATE_BEIJING
							state_region = s:STATE_SUZHOU
						}
						factor = 0.0001
					}
					# 홍콩 소유국이 소주
					modifier = {
						ROOT = {
							any_scope_state = {
								state_region = s:STATE_SHAOZHOU
								is_treaty_port = yes
							}
						}
						state_region = s:STATE_SHAOZHOU
						factor = 0.01
					}
					# 한커우 (동 호북)
					modifier = {
						state_region = s:STATE_EASTERN_HUBEI
						factor = 0.4
					}
					# 광저우 (광동)
					modifier = {
						state_region = s:STATE_GUANGDONG
						factor = 0.5
					}
					# 남 안휘
					modifier = {
						state_region = s:STATE_SOUTHERN_ANHUI
						factor = 0.769
					}
					# 절강
					modifier = {
						state_region = s:STATE_ZHEJIANG
						factor = 0.625
					}
					# 서 호북
					modifier = {
						state_region = s:STATE_WESTERN_HUBEI
						factor = 0.769
					}
					# 중경
					modifier = {
						state_region = s:STATE_CHONGQING
						factor = 0.769
					}
					# 그 외
					# 해안가
					modifier = {
						is_coastal = yes
						factor = 0.5
					}
					# 장강과 주강
					modifier = {
						OR = {
							has_state_trait = state_trait_yangtze_river
							has_state_trait = state_trait_pearl_river
						}
						factor = 0.333
					}
				}
				save_scope_as = concession_target_state
				remove_list_variable = { name = concession_owner_varlist target = scope:concession_owner_country }
				scope:concession_target_state.state_region = {
					save_scope_as = concession_state_region
					concession_state_status_calc_scope = yes
				}
			}
		}
	}

	option = {
		name = concessions_in_china.1004.a
		default_option = yes
		
		ai_chance = {
			base = 1
		}
	}
}

# 조계지가 있는 주를 다른 나라가 차지했을 경우
concessions_in_china.1005 = { # TODO
	type = country_event
	placement = ROOT

	title = concessions_in_china.1005.t
	desc = {
		first_valid = {
			triggered_desc = {
				desc = concessions_in_china.1005.d1
				trigger = { exists = scope:former_state_owner }
			}
			desc = concessions_in_china.1005.d2
		}
	}
	flavor = {
		first_valid = {
			triggered_desc = {
				desc = concessions_in_china.1005.f1
				trigger = { exists = scope:former_state_owner }
			}
			desc = concessions_in_china.1005.f2
		}
	}
	
	duration = 1

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	trigger = {
		NOT = { has_variable = conchi1005 }
		any_scope_state = {
			state_is_in_china_proper = yes
			is_treaty_port = no
			has_variable_list = concession_owner_varlist
			NOT = { is_target_in_variable_list = { name = concession_state_owner_varlist target = ROOT } }
		}
	}

	immediate = {
		set_variable = conchi1005
		save_scope_as = new_owner_country
		set_local_variable = {
			name = occupied_state_num
		}
		every_scope_state = {
			limit = {
				state_is_in_china_proper = yes
				is_treaty_port = no
				has_variable_list = concession_owner_varlist
				NOT = { is_target_in_variable_list = { name = concession_state_owner_varlist target = ROOT } }
			}
			change_local_variable = {
				name = occupied_state_num
				add = 1
			}
		}
		if = {
			limit = { local_var:occupied_state_num = 1 }
			random_scope_state = {
				limit = {
					state_is_in_china_proper = yes
					is_treaty_port = no
					has_variable_list = concession_owner_varlist
					NOT = { is_target_in_variable_list = { name = concession_state_owner_varlist target = ROOT } }
				}
				random_in_list = {
					variable = concession_state_owner_varlist
					save_scope_as = former_state_owner
				}
			}
		}
		else = { save_scope_value_as = { name = occupied_state_num value = local_var:occupied_state_num } }
	}

	option = { # 전부 폐지
		name = concessions_in_china.1005.a
		default_option = yes

		every_scope_state = {
			limit = {
				state_is_in_china_proper = yes
				is_treaty_port = no
				has_variable_list = concession_owner_varlist
				NOT = { is_target_in_variable_list = { name = concession_state_owner_varlist target = ROOT } }
			}
			every_in_list = {
				variable = concession_owner_varlist
				save_scope_as = country_temp
				PREV = {
					remove_list_variable = { name = concession_state_owner_varlist target = scope:country_temp }
				}
			}
			add_to_variable_list = { name = concession_state_owner_varlist target = ROOT }
		}
		
		ai_chance = {
			base = 1
		}
	}

	option = { # 걍 놔둠
		name = concessions_in_china.1005.b
		
		ai_chance = {
			base = 0
		}
	}

	after = {
		remove_variable = conchi1005
	}
}