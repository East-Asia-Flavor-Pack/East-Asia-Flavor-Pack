namespace = manchus_and_han_events

manchus_and_han_events.1 = { # 초기화용
	type = country_event
	hidden = yes

	immediate = {
		je_manchus_and_han_d_var_calc = yes

		#################### 지지도 계산 ####################
		change_variable = {
			name = china_manchu_support_var
			add = var:china_manchu_support_d_var
		}
		change_variable = {
			name = china_han_support_var
			add = var:china_han_support_d_var
		}

		#################### 권력 계산 ####################
		change_variable = {
			name = china_manchu_power_var
			add = var:china_manchu_power_d_var
		}
		change_variable = {
			name = china_han_power_var
			add = var:china_han_power_d_var
		}

		je_manchus_and_han_modifier_calc = yes
	}
}

manchus_and_han_events.101 = { # 만주와 한
	type = country_event
	placement = ROOT

	title = manchus_and_han_events.101.t
	desc = manchus_and_han_events.101.d
	flavor = manchus_and_han_events.101.f

	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	trigger = {
		NOT = { has_global_variable = china_shatters }
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
	}

	option = {
		name = manchus_and_han_events.101.a
		default_option = yes

		chi_empire_of_chimera_decline = yes
		ig:ig_intelligentsia = { 
			add_ideology = ideology_liberal
		}
		custom_tooltip = {
			text = warlord_china_explosion_point_remove_5_tt
			post_notification = warlord_china_explosion_point_remove
			change_variable = {
				name = china_warlord_explosion
				subtract = 0.25
			}
		}

		ai_chance = {
			base = 100
		}
	}
}

manchus_and_han_events.102 = { # 동맹회
	type = country_event
	placement = ROOT

	title = manchus_and_han_events.102.t
	desc = manchus_and_han_events.102.d
	flavor = manchus_and_han_events.102.f

	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	trigger = {
		NOT = { has_global_variable = china_shatters }
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
	}

	option = {
		name = manchus_and_han_events.102.a
		default_option = yes

		chi_empire_of_chimera_decline = yes
		custom_tooltip = {
			text = warlord_china_explosion_point_remove_5_tt
			post_notification = warlord_china_explosion_point_remove
			change_variable = {
				name = china_warlord_explosion
				subtract = 0.25
			}
		}

		ai_chance = {
			base = 100
		}
	}
}

manchus_and_han_events.103 = { # (주 이름) 봉기
	type = country_event
	placement = scope:revolt_state

	title = manchus_and_han_events.103.t
	desc = manchus_and_han_events.103.d
	flavor = manchus_and_han_events.103.f

	duration = 3

	event_image = {
		texture = "gfx/event_pictures/china/coronation.png"
	}

	trigger = {
		NOT = { has_global_variable = china_shatters }
		any_scope_state = {
			state_is_in_china = yes
			NOT = { has_modifier = anti_manchu_revolt }
		}
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
		random_scope_state = {
			limit = {
				state_is_in_china = yes
				NOT = { has_modifier = anti_manchu_revolt }
			}
			save_scope_as = revolt_state
			if = {
				limit = {
					any_neighbouring_state = {
						state_is_in_china = yes
						NOT = { has_modifier = anti_manchu_revolt }
					}
				}
				random_neighbouring_state = {
					limit = {
						state_is_in_china = yes
						NOT = { has_modifier = anti_manchu_revolt }
					}
					save_scope_as = revolt_state1
				}
			}
			else = {
				random_neighbouring_state = {
					limit = {
						state_is_in_china = yes
					}
					save_scope_as = revolt_state1
				}
			}
			if = {
				limit = {
					any_neighbouring_state = {
						state_is_in_china = yes
						NOT = { has_modifier = anti_manchu_revolt }
					}
				}
				random_neighbouring_state = {
					limit = {
						state_is_in_china = yes
						NOT = { has_modifier = anti_manchu_revolt }
					}
					save_scope_as = revolt_state2
				}
			}
			else = {
				random_neighbouring_state = {
					limit = {
						state_is_in_china = yes
					}
					save_scope_as = revolt_state2
				}
			}
		}
	}

	option = {
		name = manchus_and_han_events.103.a
		default_option = yes

		scope:revolt_state = {
			add_modifier = {
				name = anti_manchu_revolt
				years = 1
			}
			kill_population_percent_in_state = {
				percent = 0.025
			}
			kill_population_percent_in_state = {
				percent = 0.025
				strata = poor
			}
			add_radicals_in_state = {
				value = 0.05
			}
		}
		scope:revolt_state1 = {
			add_modifier = {
				name = anti_manchu_revolt
				years = 1
				multiplier = 0.5
			}
			add_radicals_in_state = {
				value = 0.05
			}
		}
		scope:revolt_state2 = {
			add_modifier = {
				name = anti_manchu_revolt
				years = 1
				multiplier = 0.5
			}
			add_radicals_in_state = {
				value = 0.05
			}
		}

		ig:ig_landowners = {
			add_modifier = {
				name = manhan103a_ig_landowners
				years = 1
				is_decaying = yes
			}
		}
		ig:ig_rural_folk = {
			add_modifier = {
				name = manhan103a_ig_rural_folk
				years = 1
				is_decaying = yes
			}
		}

		ai_chance = {
			base = 8
		}
	}

	option = {
		name = manchus_and_han_events.103.b

		scope:revolt_state = {
			add_modifier = {
				name = anti_manchu_revolt
				years = 1
			}
			add_radicals_in_state = {
				value = 0.02
			}
		}
		scope:revolt_state1 = {
			add_modifier = {
				name = anti_manchu_revolt
				years = 1
				multiplier = 0.5
			}
			add_radicals_in_state = {
				value = 0.02
			}
		}
		scope:revolt_state2 = {
			add_modifier = {
				name = anti_manchu_revolt
				years = 1
				multiplier = 0.5
			}
			add_radicals_in_state = {
				value = 0.02
			}
		}

		ig:ig_landowners = {
			add_modifier = {
				name = manhan103b_ig_landowners
				years = 1
				is_decaying = yes
			}
		}
		ig:ig_rural_folk = {
			add_modifier = {
				name = manhan103b_ig_rural_folk
				years = 1
				is_decaying = yes
			}
		}
		add_modifier = {
			name = manhan103b
			years = 3
		}

		ai_chance = {
			base = 2
		}
	}
}